#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
Package: data
Module : cie.py
Website: https://github.com/ruminations/site-packages
License: https://github.com/ruminations/Licenses#design-license
Initial Copyright 2018

For discussion, see:
  https://github.com/ruminations/Essays/blob/master/Heat_Colors.pdf

Data included here:
  cie_lms_2006_10deg         : CIE proposed standard reference LMS data
  cie_lms_10deg_to_xyz       : CIE proposed standard transformation to XYZ
  lms_10deg_to_xyz_rectified : transformation rectified per discussion
  lms_10deg_rectified        : data rectified per discussion

  <Use These>:
  lms2xyz                    : final 10 deg adjusted transformation matrix
  lms2018                    : final 10 deg adjusted data
  lms                        : 'data.analysis.Interpolant' instance on 'lms2018'

Data is a tuple of tuples '(<wavelength>,V(<data>))' where <wavelength> is
in nanometers, <data> is either LMS or XYZ, and 'V' is the general vector
class from 'geometry.space'.  Transformations are 3x3 'SqM' instances from
'geometry.space'.

The rectified data was generated by the code after 'if __name__=="__main__":'
which follows the discussion in a straitforward way.
"""
from geometry.space import V,SqM
from geometry.gauss import C,Angle
from data.analysis import Interpolant
__all__=('lms','lms2018','lms2xyz','cie_lms_2006_10deg','cie_lms_10deg_to_xyz', \
        'lms_10deg_to_xyz_rectified','lms_10deg_rectified')
__version__=20181205
__version_history__=(20180323,20180410)

### Useful facts:
# for sunlight, 0.0079 W/(m*m) == 1.0 lux == lumen/(m*m)
# from: http://bccp.berkeley.edu/o/Academy/workshop08/08%20PDFs/Inv_Square_Law.pdf
# clear day sunshine = 1361 W/(m*m) => 172278 lux
# calculated from: solar luminosity and distance of sun from the earth.
#
# candela (lumen/steradian) is defined as 555 nm light emitting (1/683)*W/steradian,
# giving a total radiant flux (optical power) of (4*pi/683)*W == 18.4 mW through an
# enveloping 1m radius sphere.   Other wavelengths require more radient flux to yield
# the same candela due to diminishing human perceptual radiant flux response.
# lumens = 4*pi*candelas (candela is a weighted radiance flux / steradian)
# from: https://en.wikipedia.org/wiki/Candela
#
# possibly useful: http://www.kayelaby.npl.co.uk/general_physics/2_5/2_5_3.html
#
# ./docs/LED_luminosity.pdf is *very* useful; obtained from:
# https://www.ecse.rpi.edu/~schubert/Light-Emitting-Diodes-dot-org/Sample-Chapter.pdf
#
# SI nit == cd/(m*m) is used by sRGB to quantify monitor brightness
#
# CIE-LMS 2006 Cone Fundamentals data for normalized cone response:
# wavelength (nanometers), V(L,M,S) linear values in normalized units of
# energy.  The data is a cubic interpolation from 5 nm spaced empirical data.
# from: http://www.cvrl.org/ciepr8dp.htm
# The transformation to CIE-XYZ is based on correlated integrals in 1 nm
# steps only.  Therefore, we choose the 1 nm cubic interpolation as reference.
# from: http://www.cvrl.org/database/text/cienewxyz/cie2012xyz10.htm
cie_lms_2006_10deg = ( \
  (390.0, V(4.07619067e-04, 3.58227395e-04, 6.14264795e-03)),
  (391.0, V(4.97068044e-04, 4.38659772e-04, 7.44279983e-03)),
  (392.0, V(6.04713055e-04, 5.36229645e-04, 9.01661277e-03)),
  (393.0, V(7.33639961e-04, 6.54061427e-04, 1.09170443e-02)),
  (394.0, V(8.87247144e-04, 7.95648906e-04, 1.32053126e-02)),
  (395.0, V(1.06920754e-03, 9.64828092e-04, 1.59514687e-02)),
  (396.0, V(1.28340265e-03, 1.16571964e-03, 1.92347428e-02)),
  (397.0, V(1.53382255e-03, 1.40263299e-03, 2.31435510e-02)),
  (398.0, V(1.82442670e-03, 1.67992438e-03, 2.77750287e-02)),
  (399.0, V(2.15896116e-03, 2.00180227e-03, 3.32339394e-02)),
  (400.0, V(2.54073042e-03, 2.37207532e-03, 3.96307943e-02)),
  (401.0, V(2.97282194e-03, 2.79433492e-03, 4.70800883e-02)),
  (402.0, V(3.45993397e-03, 3.27374173e-03, 5.57011972e-02)),
  (403.0, V(4.00792850e-03, 3.81659740e-03, 6.56137204e-02)),
  (404.0, V(4.62370068e-03, 4.43020960e-03, 7.69323091e-02)),
  (405.0, V(5.31546236e-03, 5.12316225e-03, 8.97612227e-02)),
  (406.0, V(6.09137851e-03, 5.90457922e-03, 1.04187586e-01)),
  (407.0, V(6.95291034e-03, 6.78004939e-03, 1.20272661e-01)),
  (408.0, V(7.89633545e-03, 7.75259599e-03, 1.38043703e-01)),
  (409.0, V(8.91300306e-03, 8.82285581e-03, 1.57485212e-01)),
  (410.0, V(9.98835098e-03, 9.98840819e-03, 1.78529924e-01)),
  (411.0, V(1.11054038e-02, 1.12451666e-02, 2.01077133e-01)),
  (412.0, V(1.22607072e-02, 1.25949359e-02, 2.25091371e-01)),
  (413.0, V(1.34578105e-02, 1.40425046e-02, 2.50565778e-01)),
  (414.0, V(1.47044177e-02, 1.55944426e-02, 2.77506961e-01)),
  (415.0, V(1.60129841e-02, 1.72595696e-02, 3.05941113e-01)),
  (416.0, V(1.73957850e-02, 1.90466824e-02, 3.35857654e-01)),
  (417.0, V(1.88451502e-02, 2.09545063e-02, 3.66980778e-01)),
  (418.0, V(2.03439676e-02, 2.29762958e-02, 3.98876194e-01)),
  (419.0, V(2.18700082e-02, 2.51016912e-02, 4.30998456e-01)),
  (420.0, V(2.33957137e-02, 2.73163327e-02, 4.62692207e-01)),
  (421.0, V(2.48960713e-02, 2.96062323e-02, 4.93356936e-01)),
  (422.0, V(2.63760991e-02, 3.19745711e-02, 5.23006416e-01)),
  (423.0, V(2.78541460e-02, 3.44330162e-02, 5.51939343e-01)),
  (424.0, V(2.93550613e-02, 3.69982979e-02, 5.80598887e-01)),
  (425.0, V(3.09103789e-02, 3.96928205e-02, 6.09570091e-01)),
  (426.0, V(3.25498144e-02, 4.25401678e-02, 6.39359480e-01)),
  (427.0, V(3.42713708e-02, 4.55473988e-02, 6.69651384e-01)),
  (428.0, V(3.60619705e-02, 4.87160707e-02, 6.99829407e-01)),
  (429.0, V(3.79051936e-02, 5.20466512e-02, 7.29177312e-01)),
  (430.0, V(3.97809896e-02, 5.55383864e-02, 7.56884632e-01)),
  (431.0, V(4.16704959e-02, 5.91875912e-02, 7.82292492e-01)),
  (432.0, V(4.35728181e-02, 6.29818835e-02, 8.05666218e-01)),
  (433.0, V(4.54931897e-02, 6.69031370e-02, 8.27598827e-01)),
  (434.0, V(4.74384679e-02, 7.09284594e-02, 8.48779613e-01)),
  (435.0, V(4.94171973e-02, 7.50298610e-02, 8.69984288e-01)),
  (436.0, V(5.14343241e-02, 7.91768755e-02, 8.91761454e-01)),
  (437.0, V(5.34734957e-02, 8.33462967e-02, 9.13444187e-01)),
  (438.0, V(5.55101837e-02, 8.75159754e-02, 9.33976780e-01)),
  (439.0, V(5.75166148e-02, 9.16624524e-02, 9.52217574e-01)),
  (440.0, V(5.94618805e-02, 9.57611568e-02, 9.66959512e-01)),
  (441.0, V(6.13240417e-02, 9.97976650e-02, 9.77339714e-01)),
  (442.0, V(6.31288104e-02, 1.03804444e-01, 9.84028489e-01)),
  (443.0, V(6.49188709e-02, 1.07833911e-01, 9.88144262e-01)),
  (444.0, V(6.67425220e-02, 1.11948323e-01, 9.90851399e-01)),
  (445.0, V(6.86537572e-02, 1.16220119e-01, 9.93336464e-01)),
  (446.0, V(7.06962597e-02, 1.20706423e-01, 9.96373055e-01)),
  (447.0, V(7.28507773e-02, 1.25363380e-01, 9.99038261e-01)),
  (448.0, V(7.50777929e-02, 1.30110900e-01, 9.99977704e-01)),
  (449.0, V(7.73325481e-02, 1.34856157e-01, 9.97843807e-01)),
  (450.0, V(7.95647427e-02, 1.39493318e-01, 9.91328844e-01)),
  (451.0, V(8.17367878e-02, 1.43943197e-01, 9.79656833e-01)),
  (452.0, V(8.38826467e-02, 1.48281321e-01, 9.63905274e-01)),
  (453.0, V(8.60598412e-02, 1.52637200e-01, 9.45572609e-01)),
  (454.0, V(8.83322210e-02, 1.57157314e-01, 9.26077974e-01)),
  (455.0, V(9.07704422e-02, 1.62006089e-01, 9.06735013e-01)),
  (456.0, V(9.34396502e-02, 1.67331022e-01, 8.88508684e-01)),
  (457.0, V(9.63577369e-02, 1.73144024e-01, 8.71352726e-01)),
  (458.0, V(9.95304112e-02, 1.79417301e-01, 8.54998119e-01)),
  (459.0, V(1.02963638e-01, 1.86116982e-01, 8.39198110e-01)),
  (460.0, V(1.06663473e-01, 1.93201620e-01, 8.23725866e-01)),
  (461.0, V(1.10628875e-01, 2.00620869e-01, 8.08307014e-01)),
  (462.0, V(1.14828329e-01, 2.08314694e-01, 7.92431266e-01)),
  (463.0, V(1.19216554e-01, 2.16212216e-01, 7.75568995e-01)),
  (464.0, V(1.23740001e-01, 2.24230755e-01, 7.57244298e-01)),
  (465.0, V(1.28336042e-01, 2.32275228e-01, 7.37042702e-01)),
  (466.0, V(1.32947308e-01, 2.40257457e-01, 7.14729722e-01)),
  (467.0, V(1.37570252e-01, 2.48160008e-01, 6.90557634e-01)),
  (468.0, V(1.42217721e-01, 2.55986600e-01, 6.64889610e-01)),
  (469.0, V(1.46905145e-01, 2.63743829e-01, 6.38077566e-01)),
  (470.0, V(1.51650594e-01, 2.71441153e-01, 6.10456321e-01)),
  (471.0, V(1.56475083e-01, 2.79096592e-01, 5.82345911e-01)),
  (472.0, V(1.61403513e-01, 2.86755395e-01, 5.54065304e-01)),
  (473.0, V(1.66464397e-01, 2.94475679e-01, 5.25902909e-01)),
  (474.0, V(1.71689909e-01, 3.02323267e-01, 4.98108396e-01)),
  (475.0, V(1.77116190e-01, 3.10372033e-01, 4.70893608e-01)),
  (476.0, V(1.82777360e-01, 3.18691700e-01, 4.44450133e-01)),
  (477.0, V(1.88685048e-01, 3.27307200e-01, 4.18991977e-01)),
  (478.0, V(1.94844690e-01, 3.36232014e-01, 3.94699394e-01)),
  (479.0, V(2.01261435e-01, 3.45480209e-01, 3.71706607e-01)),
  (480.0, V(2.07940052e-01, 3.55066420e-01, 3.50107654e-01)),
  (481.0, V(2.14875444e-01, 3.64984972e-01, 3.29904165e-01)),
  (482.0, V(2.22021744e-01, 3.75142281e-01, 3.10863616e-01)),
  (483.0, V(2.29315613e-01, 3.85410322e-01, 2.92741063e-01)),
  (484.0, V(2.36684385e-01, 3.95645506e-01, 2.75337977e-01)),
  (485.0, V(2.44045655e-01, 4.05688377e-01, 2.58496996e-01)),
  (486.0, V(2.51346893e-01, 4.15434894e-01, 2.42158115e-01)),
  (487.0, V(2.58694521e-01, 4.25064168e-01, 2.26504208e-01)),
  (488.0, V(2.66251732e-01, 4.34850607e-01, 2.11725770e-01)),
  (489.0, V(2.74202135e-01, 4.45097029e-01, 1.97959651e-01)),
  (490.0, V(2.82751994e-01, 4.56137225e-01, 1.85297483e-01)),
  (491.0, V(2.92071421e-01, 4.68235946e-01, 1.73750715e-01)),
  (492.0, V(3.02093753e-01, 4.81255347e-01, 1.63149273e-01)),
  (493.0, V(3.12672693e-01, 4.94927331e-01, 1.53311198e-01)),
  (494.0, V(3.23636751e-01, 5.08947269e-01, 1.44086161e-01)),
  (495.0, V(3.34785930e-01, 5.22969940e-01, 1.35350675e-01)),
  (496.0, V(3.45942793e-01, 5.36700586e-01, 1.27010990e-01)),
  (497.0, V(3.57126009e-01, 5.50194516e-01, 1.19016606e-01)),
  (498.0, V(3.68416282e-01, 5.63615862e-01, 1.11333118e-01)),
  (499.0, V(3.79907104e-01, 5.77149817e-01, 1.03933852e-01)),
  (500.0, V(3.91705331e-01, 5.91002878e-01, 9.67990105e-02)),
  (501.0, V(4.03904967e-01, 6.05349641e-01, 8.99168668e-02)),
  (502.0, V(4.16499822e-01, 6.20160188e-01, 8.32878080e-02)),
  (503.0, V(4.29452625e-01, 6.35343046e-01, 7.69157035e-02)),
  (504.0, V(4.42719906e-01, 6.50795785e-01, 7.08052103e-02)),
  (505.0, V(4.56251511e-01, 6.66404323e-01, 6.49613925e-02)),
  (506.0, V(4.69996797e-01, 6.82054621e-01, 5.94049435e-02)),
  (507.0, V(4.83925822e-01, 6.97671514e-01, 5.42075628e-02)),
  (508.0, V(4.98012242e-01, 7.13186442e-01, 4.94280547e-02)),
  (509.0, V(5.12227030e-01, 7.28525980e-01, 4.50992516e-02)),
  (510.0, V(5.26538428e-01, 7.43612020e-01, 4.12337488e-02)),
  (511.0, V(5.40923476e-01, 7.58395898e-01, 3.78142449e-02)),
  (512.0, V(5.55405564e-01, 7.72966152e-01, 3.47626978e-02)),
  (513.0, V(5.70024839e-01, 7.87457289e-01, 3.20029319e-02)),
  (514.0, V(5.84827637e-01, 8.02017289e-01, 2.94745661e-02)),
  (515.0, V(5.99866880e-01, 8.16807889e-01, 2.71299980e-02)),
  (516.0, V(6.15162077e-01, 8.31919048e-01, 2.49376452e-02)),
  (517.0, V(6.30568785e-01, 8.47096033e-01, 2.28930546e-02)),
  (518.0, V(6.45883282e-01, 8.61972341e-01, 2.09956388e-02)),
  (519.0, V(6.60880257e-01, 8.76152354e-01, 1.92426952e-02)),
  (520.0, V(6.75313179e-01, 8.89213535e-01, 1.76298483e-02)),
  (521.0, V(6.88974718e-01, 9.00812461e-01, 1.61501083e-02)),
  (522.0, V(7.01886306e-01, 9.11005791e-01, 1.47911006e-02)),
  (523.0, V(7.14140025e-01, 9.19968031e-01, 1.35407174e-02)),
  (524.0, V(7.25841255e-01, 9.27890228e-01, 1.23884497e-02)),
  (525.0, V(7.37107602e-01, 9.34976841e-01, 1.13251604e-02)),
  (526.0, V(7.48046129e-01, 9.41414000e-01, 1.03437432e-02)),
  (527.0, V(7.58684497e-01, 9.47278730e-01, 9.44091928e-03)),
  (528.0, V(7.69031622e-01, 9.52622262e-01, 8.61364666e-03)),
  (529.0, V(7.79098781e-01, 9.57498116e-01, 7.85830827e-03)),
  (530.0, V(7.88899549e-01, 9.61961662e-01, 7.17089441e-03)),
  (531.0, V(7.98471677e-01, 9.66080420e-01, 6.54647684e-03)),
  (532.0, V(8.07944800e-01, 9.69966148e-01, 5.97776515e-03)),
  (533.0, V(8.17478097e-01, 9.73743400e-01, 5.45793833e-03)),
  (534.0, V(8.27238915e-01, 9.77538784e-01, 4.98125342e-03)),
  (535.0, V(8.37403142e-01, 9.81480903e-01, 4.54287284e-03)),
  (536.0, V(8.48078498e-01, 9.85628647e-01, 4.13907542e-03)),
  (537.0, V(8.59064181e-01, 9.89753570e-01, 3.76794458e-03)),
  (538.0, V(8.70067557e-01, 9.93551359e-01, 3.42782661e-03)),
  (539.0, V(8.80778781e-01, 9.96713819e-01, 3.11695923e-03)),
  (540.0, V(8.90871319e-01, 9.98930730e-01, 2.83351880e-03)),
  (541.0, V(9.00057028e-01, 9.99942423e-01, 2.57556270e-03)),
  (542.0, V(9.08253231e-01, 9.99692001e-01, 2.34084109e-03)),
  (543.0, V(9.15433213e-01, 9.98177985e-01, 2.12721718e-03)),
  (544.0, V(9.21574627e-01, 9.95404787e-01, 1.93276095e-03)),
  (545.0, V(9.26659723e-01, 9.91382642e-01, 1.75572783e-03)),
  (546.0, V(9.30743578e-01, 9.86199116e-01, 1.59454795e-03)),
  (547.0, V(9.34159981e-01, 9.80228632e-01, 1.44782819e-03)),
  (548.0, V(9.37318404e-01, 9.73906478e-01, 1.31430305e-03)),
  (549.0, V(9.40633969e-01, 9.67653446e-01, 1.19281486e-03)),
  (550.0, V(9.44527173e-01, 9.61875524e-01, 1.08230483e-03)),
  (551.0, V(9.49290527e-01, 9.56820225e-01, 9.81819071e-04)),
  (552.0, V(9.54679658e-01, 9.52151139e-01, 8.90533043e-04)),
  (553.0, V(9.60309190e-01, 9.47398403e-01, 8.07686839e-04)),
  (554.0, V(9.65784727e-01, 9.42105181e-01, 7.32568180e-04)),
  (555.0, V(9.70702545e-01, 9.35829058e-01, 6.64512043e-04)),
  (556.0, V(9.74755906e-01, 9.28273802e-01, 6.02886518e-04)),
  (557.0, V(9.78054920e-01, 9.19666908e-01, 5.47061576e-04)),
  (558.0, V(9.80818797e-01, 9.10356424e-01, 4.96461134e-04)),
  (559.0, V(9.83270530e-01, 9.00677220e-01, 4.50570942e-04)),
  (560.0, V(9.85635735e-01, 8.90949073e-01, 4.08931409e-04)),
  (561.0, V(9.88084787e-01, 8.81385756e-01, 3.71136209e-04)),
  (562.0, V(9.90559894e-01, 8.71833582e-01, 3.36837835e-04)),
  (563.0, V(9.92945254e-01, 8.62058662e-01, 3.05722867e-04)),
  (564.0, V(9.95124157e-01, 8.51839703e-01, 2.77504057e-04)),
  (565.0, V(9.96979206e-01, 8.40968769e-01, 2.51918429e-04)),
  (566.0, V(9.98410673e-01, 8.29303080e-01, 2.28724584e-04)),
  (567.0, V(9.99391084e-01, 8.16911267e-01, 2.07698937e-04)),
  (568.0, V(9.99911686e-01, 8.03910320e-01, 1.88637795e-04)),
  (569.0, V(9.99964539e-01, 7.90412683e-01, 1.71356528e-04)),
  (570.0, V(9.99542570e-01, 7.76525624e-01, 1.55687802e-04)),
  (571.0, V(9.98614615e-01, 7.62310573e-01, 1.41480078e-04)),
  (572.0, V(9.97051085e-01, 7.47669191e-01, 1.28596357e-04)),
  (573.0, V(9.94700550e-01, 7.32476180e-01, 1.16912488e-04)),
  (574.0, V(9.91416137e-01, 7.16621868e-01, 1.06315891e-04)),
  (575.0, V(9.87057062e-01, 7.00013057e-01, 9.67045032e-05)),
  (576.0, V(9.81598718e-01, 6.82647325e-01, 8.79857598e-05)),
  (577.0, V(9.75451484e-01, 6.64816869e-01, 8.00756039e-05)),
  (578.0, V(9.69120471e-01, 6.46857886e-01, 7.28978842e-05)),
  (579.0, V(9.63093221e-01, 6.29072199e-01, 6.63836633e-05)),
  (580.0, V(9.57840611e-01, 6.11727998e-01, 6.04705364e-05)),
  (581.0, V(9.53663865e-01, 5.94997609e-01, 5.51020014e-05)),
  (582.0, V(9.50236431e-01, 5.78782770e-01, 5.02268730e-05)),
  (583.0, V(9.47086423e-01, 5.62934758e-01, 4.57988214e-05)),
  (584.0, V(9.43752127e-01, 5.47321206e-01, 4.17759209e-05)),
  (585.0, V(9.39781455e-01, 5.31825085e-01, 3.81202298e-05)),
  (586.0, V(9.34826216e-01, 5.16354357e-01, 3.47973998e-05)),
  (587.0, V(9.28916686e-01, 5.00869891e-01, 3.17763096e-05)),
  (588.0, V(9.22176613e-01, 4.85349572e-01, 2.90287919e-05)),
  (589.0, V(9.14728596e-01, 4.69777154e-01, 2.65293593e-05)),
  (590.0, V(9.06693013e-01, 4.54142113e-01, 2.42549460e-05)),
  (591.0, V(8.98169931e-01, 4.38453530e-01, 2.21846700e-05)),
  (592.0, V(8.89188195e-01, 4.22777713e-01, 2.02996102e-05)),
  (593.0, V(8.79759202e-01, 4.07188470e-01, 1.85826373e-05)),
  (594.0, V(8.69894432e-01, 3.91752057e-01, 1.70182453e-05)),
  (595.0, V(8.59605469e-01, 3.76527354e-01, 1.55923957e-05)),
  (596.0, V(8.48911921e-01, 3.61558577e-01, 1.42923722e-05)),
  (597.0, V(8.37864745e-01, 3.46855675e-01, 1.31066459e-05)),
  (598.0, V(8.26521803e-01, 3.32421684e-01, 1.20247729e-05)),
  (599.0, V(8.14939624e-01, 3.18260743e-01, 1.10372926e-05)),
  (600.0, V(8.03173191e-01, 3.04377894e-01, 1.01356328e-05)),
  (601.0, V(7.91252870e-01, 2.90783681e-01, 9.31202271e-06)),
  (602.0, V(7.79118217e-01, 2.77506436e-01, 8.55941183e-06)),
  (603.0, V(7.66691243e-01, 2.64574629e-01, 7.87140697e-06)),
  (604.0, V(7.53900201e-01, 2.52011897e-01, 7.24221093e-06)),
  (605.0, V(7.40679903e-01, 2.39837365e-01, 6.66656535e-06)),
  (606.0, V(7.26994963e-01, 2.28065172e-01, 6.13969783e-06)),
  (607.0, V(7.12905207e-01, 2.16702729e-01, 5.65727227e-06)),
  (608.0, V(6.98490890e-01, 2.05754111e-01, 5.21535214e-06)),
  (609.0, V(6.83828630e-01, 1.95221164e-01, 4.81036370e-06)),
  (610.0, V(6.68991113e-01, 1.85103689e-01, 4.43906145e-06)),
  (611.0, V(6.54036567e-01, 1.75397731e-01, 4.09849692e-06)),
  (612.0, V(6.38979498e-01, 1.66090878e-01, 3.78599059e-06)),
  (613.0, V(6.23824796e-01, 1.57169390e-01, 3.49910645e-06)),
  (614.0, V(6.08578508e-01, 1.48620247e-01, 3.23562911e-06)),
  (615.0, V(5.93247836e-01, 1.40431078e-01, 2.99354308e-06)),
  (616.0, V(5.77857191e-01, 1.32590942e-01, 0.00000000e+00)),
  (617.0, V(5.62492819e-01, 1.25092399e-01, 0.00000000e+00)),
  (618.0, V(5.47248471e-01, 1.17928361e-01, 0.00000000e+00)),
  (619.0, V(5.32208633e-01, 1.11091220e-01, 0.00000000e+00)),
  (620.0, V(5.17448826e-01, 1.04572924e-01, 0.00000000e+00)),
  (621.0, V(5.02992596e-01, 9.83663235e-02, 0.00000000e+00)),
  (622.0, V(4.88692023e-01, 9.24684983e-02, 0.00000000e+00)),
  (623.0, V(4.74375977e-01, 8.68759428e-02, 0.00000000e+00)),
  (624.0, V(4.59895656e-01, 8.15833956e-02, 0.00000000e+00)),
  (625.0, V(4.45124577e-01, 7.65841125e-02, 0.00000000e+00)),
  (626.0, V(4.30006798e-01, 7.18682764e-02, 0.00000000e+00)),
  (627.0, V(4.14686627e-01, 6.74186151e-02, 0.00000000e+00)),
  (628.0, V(3.99339826e-01, 6.32175665e-02, 0.00000000e+00)),
  (629.0, V(3.84121824e-01, 5.92491871e-02, 0.00000000e+00)),
  (630.0, V(3.69167951e-01, 5.54989859e-02, 0.00000000e+00)),
  (631.0, V(3.54579976e-01, 5.19549507e-02, 0.00000000e+00)),
  (632.0, V(3.40389351e-01, 4.86103353e-02, 0.00000000e+00)),
  (633.0, V(3.26608965e-01, 4.54590622e-02, 0.00000000e+00)),
  (634.0, V(3.13248812e-01, 4.24945164e-02, 0.00000000e+00)),
  (635.0, V(3.00316199e-01, 3.97096689e-02, 0.00000000e+00)),
  (636.0, V(2.87817470e-01, 3.70952079e-02, 0.00000000e+00)),
  (637.0, V(2.75762189e-01, 3.46347488e-02, 0.00000000e+00)),
  (638.0, V(2.64157901e-01, 3.23124852e-02, 0.00000000e+00)),
  (639.0, V(2.53008850e-01, 3.01150932e-02, 0.00000000e+00)),
  (640.0, V(2.42316360e-01, 2.80314193e-02, 0.00000000e+00)),
  (641.0, V(2.32061402e-01, 2.60564136e-02, 0.00000000e+00)),
  (642.0, V(2.22157765e-01, 2.42010920e-02, 0.00000000e+00)),
  (643.0, V(2.12515740e-01, 2.24759554e-02, 0.00000000e+00)),
  (644.0, V(2.03060278e-01, 2.08870081e-02, 0.00000000e+00)),
  (645.0, V(1.93730034e-01, 1.94366360e-02, 0.00000000e+00)),
  (646.0, V(1.84494786e-01, 1.81200153e-02, 0.00000000e+00)),
  (647.0, V(1.75401963e-01, 1.69149301e-02, 0.00000000e+00)),
  (648.0, V(1.66509307e-01, 1.57990764e-02, 0.00000000e+00)),
  (649.0, V(1.57865232e-01, 1.47543068e-02, 0.00000000e+00)),
  (650.0, V(1.49509341e-01, 1.37659889e-02, 0.00000000e+00)),
  (651.0, V(1.41470357e-01, 1.28245918e-02, 0.00000000e+00)),
  (652.0, V(1.33759912e-01, 1.19303621e-02, 0.00000000e+00)),
  (653.0, V(1.26383268e-01, 1.10849590e-02, 0.00000000e+00)),
  (654.0, V(1.19342679e-01, 1.02891947e-02, 0.00000000e+00)),
  (655.0, V(1.12637747e-01, 9.54315350e-03, 0.00000000e+00)),
  (656.0, V(1.06263913e-01, 8.84608811e-03, 0.00000000e+00)),
  (657.0, V(1.00208087e-01, 8.19599838e-03, 0.00000000e+00)),
  (658.0, V(9.44558353e-02, 7.59058687e-03, 0.00000000e+00)),
  (659.0, V(8.89934088e-02, 7.02754072e-03, 0.00000000e+00)),
  (660.0, V(8.38077035e-02, 6.50455441e-03, 0.00000000e+00)),
  (661.0, V(7.88864928e-02, 6.01951703e-03, 0.00000000e+00)),
  (662.0, V(7.42190806e-02, 5.57093190e-03, 0.00000000e+00)),
  (663.0, V(6.97952460e-02, 5.15727694e-03, 0.00000000e+00)),
  (664.0, V(6.56049536e-02, 4.77687362e-03, 0.00000000e+00)),
  (665.0, V(6.16383685e-02, 4.42794317e-03, 0.00000000e+00)),
  (666.0, V(5.78856711e-02, 4.10832308e-03, 0.00000000e+00)),
  (667.0, V(5.43365691e-02, 3.81470204e-03, 0.00000000e+00)),
  (668.0, V(5.09810577e-02, 3.54392361e-03, 0.00000000e+00)),
  (669.0, V(4.78096164e-02, 3.29329022e-03, 0.00000000e+00)),
  (670.0, V(4.48131819e-02, 3.06049600e-03, 0.00000000e+00)),
  (671.0, V(4.19831027e-02, 2.84369463e-03, 0.00000000e+00)),
  (672.0, V(3.93110669e-02, 2.64175361e-03, 0.00000000e+00)),
  (673.0, V(3.67891552e-02, 2.45373512e-03, 0.00000000e+00)),
  (674.0, V(3.44098384e-02, 2.27875103e-03, 0.00000000e+00)),
  (675.0, V(3.21659546e-02, 2.11596127e-03, 0.00000000e+00)),
  (676.0, V(3.00509343e-02, 1.96456470e-03, 0.00000000e+00)),
  (677.0, V(2.80593868e-02, 1.82377900e-03, 0.00000000e+00)),
  (678.0, V(2.61861427e-02, 1.69286817e-03, 0.00000000e+00)),
  (679.0, V(2.44260104e-02, 1.57114740e-03, 0.00000000e+00)),
  (680.0, V(2.27738100e-02, 1.45797939e-03, 0.00000000e+00)),
  (681.0, V(2.12237543e-02, 1.35274263e-03, 0.00000000e+00)),
  (682.0, V(1.97678830e-02, 1.25475932e-03, 0.00000000e+00)),
  (683.0, V(1.83985826e-02, 1.16340289e-03, 0.00000000e+00)),
  (684.0, V(1.71091988e-02, 1.07812048e-03, 0.00000000e+00)),
  (685.0, V(1.58939173e-02, 9.98423741e-04, 0.00000000e+00)),
  (686.0, V(1.47491860e-02, 9.23962373e-04, 0.00000000e+00)),
  (687.0, V(1.36773100e-02, 8.54712714e-04, 0.00000000e+00)),
  (688.0, V(1.26804157e-02, 7.90652381e-04, 0.00000000e+00)),
  (689.0, V(1.17590175e-02, 7.31684052e-04, 0.00000000e+00)),
  (690.0, V(1.09123394e-02, 6.77652785e-04, 0.00000000e+00)),
  (691.0, V(1.01373142e-02, 6.28297329e-04, 0.00000000e+00)),
  (692.0, V(9.42568046e-03, 5.83107933e-04, 0.00000000e+00)),
  (693.0, V(8.76916558e-03, 5.41583607e-04, 0.00000000e+00)),
  (694.0, V(8.16076012e-03, 5.03294254e-04, 0.00000000e+00)),
  (695.0, V(7.59452818e-03, 4.67870233e-04, 0.00000000e+00)),
  (696.0, V(7.06588422e-03, 4.35006951e-04, 0.00000000e+00)),
  (697.0, V(6.57251948e-03, 4.04490009e-04, 0.00000000e+00)),
  (698.0, V(6.11262302e-03, 3.76137802e-04, 0.00000000e+00)),
  (699.0, V(5.68439733e-03, 3.49784457e-04, 0.00000000e+00)),
  (700.0, V(5.28607164e-03, 3.25278334e-04, 0.00000000e+00)),
  (701.0, V(4.91572765e-03, 3.02476980e-04, 0.00000000e+00)),
  (702.0, V(4.57085643e-03, 2.81236920e-04, 0.00000000e+00)),
  (703.0, V(4.24907923e-03, 2.61426794e-04, 0.00000000e+00)),
  (704.0, V(3.94831733e-03, 2.42929675e-04, 0.00000000e+00)),
  (705.0, V(3.66675373e-03, 2.25641354e-04, 0.00000000e+00)),
  (706.0, V(3.40296820e-03, 2.09478426e-04, 0.00000000e+00)),
  (707.0, V(3.15631545e-03, 1.94400199e-04, 0.00000000e+00)),
  (708.0, V(2.92624484e-03, 1.80370327e-04, 0.00000000e+00)),
  (709.0, V(2.71212718e-03, 1.67347279e-04, 0.00000000e+00)),
  (710.0, V(2.51327467e-03, 1.55285744e-04, 0.00000000e+00)),
  (711.0, V(2.32895013e-03, 1.44134603e-04, 0.00000000e+00)),
  (712.0, V(2.15836215e-03, 1.33830080e-04, 0.00000000e+00)),
  (713.0, V(2.00071090e-03, 1.24309206e-04, 0.00000000e+00)),
  (714.0, V(1.85520649e-03, 1.15513348e-04, 0.00000000e+00)),
  (715.0, V(1.72107607e-03, 1.07387972e-04, 0.00000000e+00)),
  (716.0, V(1.59749665e-03, 9.98800383e-05, 0.00000000e+00)),
  (717.0, V(1.48342247e-03, 9.29320172e-05, 0.00000000e+00)),
  (718.0, V(1.37786878e-03, 8.64906961e-05, 0.00000000e+00)),
  (719.0, V(1.27997679e-03, 8.05090212e-05, 0.00000000e+00)),
  (720.0, V(1.18899676e-03, 7.49453321e-05, 0.00000000e+00)),
  (721.0, V(1.10432620e-03, 6.97652073e-05, 0.00000000e+00)),
  (722.0, V(1.02562513e-03, 6.49470250e-05, 0.00000000e+00)),
  (723.0, V(9.52602276e-04, 6.04718329e-05, 0.00000000e+00)),
  (724.0, V(8.84959446e-04, 5.63206844e-05, 0.00000000e+00)),
  (725.0, V(8.22396074e-04, 5.24748323e-05, 0.00000000e+00)),
  (726.0, V(7.64585364e-04, 4.89142417e-05, 0.00000000e+00)),
  (727.0, V(7.11109907e-04, 4.56136631e-05, 0.00000000e+00)),
  (728.0, V(6.61570387e-04, 4.25490164e-05, 0.00000000e+00)),
  (729.0, V(6.15611533e-04, 3.96989153e-05, 0.00000000e+00)),
  (730.0, V(5.72916838e-04, 3.70443421e-05, 0.00000000e+00)),
  (731.0, V(5.33205682e-04, 3.45687558e-05, 0.00000000e+00)),
  (732.0, V(4.96233558e-04, 3.22588071e-05, 0.00000000e+00)),
  (733.0, V(4.61781910e-04, 3.01026356e-05, 0.00000000e+00)),
  (734.0, V(4.29653519e-04, 2.80893295e-05, 0.00000000e+00)),
  (735.0, V(3.99670182e-04, 2.62088417e-05, 0.00000000e+00)),
  (736.0, V(3.71689607e-04, 2.44529471e-05, 0.00000000e+00)),
  (737.0, V(3.45649772e-04, 2.28177193e-05, 0.00000000e+00)),
  (738.0, V(3.21494347e-04, 2.12995276e-05, 0.00000000e+00)),
  (739.0, V(2.99154567e-04, 1.98940631e-05, 0.00000000e+00)),
  (740.0, V(2.78552580e-04, 1.85965278e-05, 0.00000000e+00)),
  (741.0, V(2.59582758e-04, 1.74002696e-05, 0.00000000e+00)),
  (742.0, V(2.42060993e-04, 1.62931103e-05, 0.00000000e+00)),
  (743.0, V(2.25808937e-04, 1.52632111e-05, 0.00000000e+00)),
  (744.0, V(2.10674430e-04, 1.43005160e-05, 0.00000000e+00)),
  (745.0, V(1.96527784e-04, 1.33965008e-05, 0.00000000e+00)),
  (746.0, V(1.83271307e-04, 1.25449275e-05, 0.00000000e+00)),
  (747.0, V(1.70867724e-04, 1.17440629e-05, 0.00000000e+00)),
  (748.0, V(1.59289520e-04, 1.09928822e-05, 0.00000000e+00)),
  (749.0, V(1.48505507e-04, 1.02900467e-05, 0.00000000e+00)),
  (750.0, V(1.38481790e-04, 9.63396916e-06, 0.00000000e+00)),
  (751.0, V(1.29178758e-04, 9.02262791e-06, 0.00000000e+00)),
  (752.0, V(1.20542285e-04, 8.45300684e-06, 0.00000000e+00)),
  (753.0, V(1.12519079e-04, 7.92206575e-06, 0.00000000e+00)),
  (754.0, V(1.05060605e-04, 7.42699934e-06, 0.00000000e+00)),
  (755.0, V(9.81226253e-05, 6.96521810e-06, 0.00000000e+00)),
  (756.0, V(9.16641429e-05, 6.53421882e-06, 0.00000000e+00)),
  (757.0, V(8.56454503e-05, 6.13128765e-06, 0.00000000e+00)),
  (758.0, V(8.00302203e-05, 5.75390612e-06, 0.00000000e+00)),
  (759.0, V(7.47857816e-05, 5.39984029e-06, 0.00000000e+00)),
  (760.0, V(6.98827164e-05, 5.06710754e-06, 0.00000000e+00)),
  (761.0, V(6.52965885e-05, 4.75413266e-06, 0.00000000e+00)),
  (762.0, V(6.10127816e-05, 4.46018608e-06, 0.00000000e+00)),
  (763.0, V(5.70183009e-05, 4.18466418e-06, 0.00000000e+00)),
  (764.0, V(5.32996460e-05, 3.92689817e-06, 0.00000000e+00)),
  (765.0, V(4.98430350e-05, 3.68617125e-06, 0.00000000e+00)),
  (766.0, V(4.66321811e-05, 3.46156583e-06, 0.00000000e+00)),
  (767.0, V(4.36424452e-05, 3.25155434e-06, 0.00000000e+00)),
  (768.0, V(4.08500899e-05, 3.05463851e-06, 0.00000000e+00)),
  (769.0, V(3.82345562e-05, 2.86951211e-06, 0.00000000e+00)),
  (770.0, V(3.57780519e-05, 2.69503733e-06, 0.00000000e+00)),
  (771.0, V(3.34676071e-05, 2.53039567e-06, 0.00000000e+00)),
  (772.0, V(3.13007448e-05, 2.37549996e-06, 0.00000000e+00)),
  (773.0, V(2.92760620e-05, 2.23033435e-06, 0.00000000e+00)),
  (774.0, V(2.73907900e-05, 2.09478127e-06, 0.00000000e+00)),
  (775.0, V(2.56410800e-05, 1.96864116e-06, 0.00000000e+00)),
  (776.0, V(2.40205191e-05, 1.85151523e-06, 0.00000000e+00)),
  (777.0, V(2.25160067e-05, 1.74247916e-06, 0.00000000e+00)),
  (778.0, V(2.11144787e-05, 1.64059913e-06, 0.00000000e+00)),
  (779.0, V(1.98046187e-05, 1.54506564e-06, 0.00000000e+00)),
  (780.0, V(1.85766264e-05, 1.45517748e-06, 0.00000000e+00)),
  (781.0, V(1.74227865e-05, 1.37038872e-06, 0.00000000e+00)),
  (782.0, V(1.63392150e-05, 1.29045066e-06, 0.00000000e+00)),
  (783.0, V(1.53228314e-05, 1.21517577e-06, 0.00000000e+00)),
  (784.0, V(1.43705232e-05, 1.14437172e-06, 0.00000000e+00)),
  (785.0, V(1.34791749e-05, 1.07784347e-06, 0.00000000e+00)),
  (786.0, V(1.26454489e-05, 1.01537558e-06, 0.00000000e+00)),
  (787.0, V(1.18651918e-05, 9.56684068e-07, 0.00000000e+00)),
  (788.0, V(1.11343735e-05, 9.01490538e-07, 0.00000000e+00)),
  (789.0, V(1.04493256e-05, 8.49541507e-07, 0.00000000e+00)),
  (790.0, V(9.80670540e-06, 8.00605973e-07, 0.00000000e+00)),
  (791.0, V(9.20362925e-06, 7.54491815e-07, 0.00000000e+00)),
  (792.0, V(8.63805755e-06, 7.11091028e-07, 0.00000000e+00)),
  (793.0, V(8.10814899e-06, 6.70308918e-07, 0.00000000e+00)),
  (794.0, V(7.61208547e-06, 6.32045144e-07, 0.00000000e+00)),
  (795.0, V(7.14808254e-06, 5.96195475e-07, 0.00000000e+00)),
  (796.0, V(6.71432071e-06, 5.62639418e-07, 0.00000000e+00)),
  (797.0, V(6.30875782e-06, 5.31206028e-07, 0.00000000e+00)),
  (798.0, V(5.92942398e-06, 5.01726345e-07, 0.00000000e+00)),
  (799.0, V(5.57449662e-06, 4.74047218e-07, 0.00000000e+00)),
  (800.0, V(5.24228869e-06, 4.48029690e-07, 0.00000000e+00)),
  (801.0, V(4.93115223e-06, 4.23543152e-07, 0.00000000e+00)),
  (802.0, V(4.63925192e-06, 4.00452736e-07, 0.00000000e+00)),
  (803.0, V(4.36487579e-06, 3.78634444e-07, 0.00000000e+00)),
  (804.0, V(4.10650663e-06, 3.57978337e-07, 0.00000000e+00)),
  (805.0, V(3.86279972e-06, 3.38386998e-07, 0.00000000e+00)),
  (806.0, V(3.63270230e-06, 3.19786564e-07, 0.00000000e+00)),
  (807.0, V(3.41578684e-06, 3.02157195e-07, 0.00000000e+00)),
  (808.0, V(3.21171530e-06, 2.85486263e-07, 0.00000000e+00)),
  (809.0, V(3.02009523e-06, 2.69755563e-07, 0.00000000e+00)),
  (810.0, V(2.84049184e-06, 2.54942293e-07, 0.00000000e+00)),
  (811.0, V(2.67238897e-06, 2.41014776e-07, 0.00000000e+00)),
  (812.0, V(2.51507284e-06, 2.27919975e-07, 0.00000000e+00)),
  (813.0, V(2.36782558e-06, 2.15603268e-07, 0.00000000e+00)),
  (814.0, V(2.22997791e-06, 2.04013924e-07, 0.00000000e+00)),
  (815.0, V(2.10090587e-06, 1.93104807e-07, 0.00000000e+00)),
  (816.0, V(1.97999661e-06, 1.82829341e-07, 0.00000000e+00)),
  (817.0, V(1.86656627e-06, 1.73134134e-07, 0.00000000e+00)),
  (818.0, V(1.75997282e-06, 1.63968868e-07, 0.00000000e+00)),
  (819.0, V(1.65964251e-06, 1.55288713e-07, 0.00000000e+00)),
  (820.0, V(1.56506236e-06, 1.47053740e-07, 0.00000000e+00)),
  (821.0, V(1.47580446e-06, 1.39231486e-07, 0.00000000e+00)),
  (822.0, V(1.39159884e-06, 1.31804422e-07, 0.00000000e+00)),
  (823.0, V(1.31221337e-06, 1.24758228e-07, 0.00000000e+00)),
  (824.0, V(1.23741997e-06, 1.18078454e-07, 0.00000000e+00)),
  (825.0, V(1.16699539e-06, 1.11750613e-07, 0.00000000e+00)),
  (826.0, V(1.10072192e-06, 1.05760262e-07, 0.00000000e+00)),
  (827.0, V(1.03838795e-06, 1.00093073e-07, 0.00000000e+00)),
  (828.0, V(9.79788446e-07, 9.47348947e-08, 0.00000000e+00)),
  (829.0, V(9.24725281e-07, 8.96718096e-08, 0.00000000e+00)),
  (830.0, V(8.73007530e-07, 8.48901776e-08, 0.00000000e+00)) )

# The integral of each x_y_z_ component should be exactly 1/3 so the sum
# is unity corresponding to equal energy spectral stimulation.
# from: http://www.cvrl.org/database/text/cienewxyz/cie2012xyz10.htm
cie_lms_10deg_to_xyz = SqM( \
  V(1.93986443,-1.34664359, 0.43044935),
  V(0.69283932, 0.34967567, 0.0       ),
  V(0.0       , 0.0       , 2.14687945) )

lms_10deg_to_xyz_rectified = SqM( \
  V(1.9397956394457376,-1.3465660535927684,0.4304397524745754),
  V(0.6928147509068754, 0.3496555365634584,0.0               ),
  V(0.0               , 0.0               ,2.1468315852919253))

lms2xyz=lms_10deg_to_xyz_rectified # to be adjusted further

lms_10deg_rectified = ( \
  (390.0, V(4.0763352209232691e-04, 3.5824802184635386e-04, 6.1427849095323428e-03)),
  (391.0, V(4.9708567115498475e-04, 4.3868503016798196e-04, 7.4429657783649950e-03)),
  (392.0, V(6.0473449949008634e-04, 5.3626052127203323e-04, 9.0168138088806832e-03)),
  (393.0, V(7.3366597752922910e-04, 6.5409908806319335e-04, 1.0917287711846824e-02)),
  (394.0, V(8.8727860778671074e-04, 7.9569471971487700e-04, 1.3205607032214390e-02)),
  (395.0, V(1.0692454565131334e-03, 9.6488364710574934e-04, 1.5951824361875970e-02)),
  (396.0, V(1.2834481623552852e-03, 1.1657867625044247e-03, 1.9235171667387495e-02)),
  (397.0, V(1.5338769428102689e-03, 1.4027137540498168e-03, 2.3144067020118279e-02)),
  (398.0, V(1.8244913982894747e-03, 1.6800211105754835e-03, 2.7775647985847491e-02)),
  (399.0, V(2.1590377216366466e-03, 2.0019175344058782e-03, 3.3234680400434209e-02)),
  (400.0, V(2.5408205200364610e-03, 2.3722119048448453e-03, 3.9631677927891081e-02)),
  (401.0, V(2.9729273629772188e-03, 2.7944958186857526e-03, 4.7081138021053320e-02)),
  (402.0, V(3.4600566670694708e-03, 3.2739302330810297e-03, 5.5702439141583099e-02)),
  (403.0, V(4.0080706301926167e-03, 3.8168171608816718e-03, 6.5615183356128121e-02)),
  (404.0, V(4.6238646468642420e-03, 4.4304646928656211e-03, 7.6934024421008496e-02)),
  (405.0, V(5.3156508582950859e-03, 5.1234572432976976e-03, 8.9763224060843666e-02)),
  (406.0, V(6.0915945240334170e-03, 5.9049192075332118e-03, 1.0418990901821147e-01)),
  (407.0, V(6.9531569058970399e-03, 6.7804397873816383e-03, 1.2027534265903993e-01)),
  (408.0, V(7.8966154718812485e-03, 7.7530423869215112e-03, 1.3804678089102673e-01)),
  (409.0, V(8.9133191352098549e-03, 8.8233638328194027e-03, 1.5748872336857625e-01)),
  (410.0, V(9.9887051894747229e-03, 9.9889833256929447e-03, 1.7853390459193680e-01)),
  (411.0, V(1.1105797622689498e-02, 1.1245814100238449e-02, 2.0108161631571736e-01)),
  (412.0, V(1.2261141992356190e-02, 1.2595661120380328e-02, 2.2509638974910587e-01)),
  (413.0, V(1.3458287744341702e-02, 1.4043313171842495e-02, 2.5057136473914826e-01)),
  (414.0, V(1.4704939151847262e-02, 1.5595340532921864e-02, 2.7751314843315750e-01)),
  (415.0, V(1.6013551956565931e-02, 1.7260563411459540e-02, 3.0594793441514573e-01)),
  (416.0, V(1.7396401893807555e-02, 1.9047779113978047e-02, 3.3586514244921606e-01)),
  (417.0, V(1.8845818491569528e-02, 2.0955712867079746e-02, 3.6698896038586076e-01)),
  (418.0, V(2.0344689043018151e-02, 2.2977618782356633e-02, 3.9888508754191188e-01)),
  (419.0, V(2.1870783759862907e-02, 2.5103136563293906e-02, 4.3100806575583406e-01)),
  (420.0, V(2.3396543364824260e-02, 2.7317905583049754e-02, 4.6270252341546209e-01)),
  (421.0, V(2.4896954170891852e-02, 2.9607937036190732e-02, 4.9336793613150404e-01)),
  (422.0, V(2.6377034456018845e-02, 3.1976412205885582e-02, 5.2301807721104954e-01)),
  (423.0, V(2.7855133770898648e-02, 3.4434998863929589e-02, 5.5195164931397311e-01)),
  (424.0, V(2.9356102296743541e-02, 3.7000428273658709e-02, 5.8061183232141345e-01)),
  (425.0, V(3.0911475051816812e-02, 3.9695106025119609e-02, 6.0958368227778015e-01)),
  (426.0, V(3.2550968689900713e-02, 4.2542617276274917e-02, 6.3937373547680620e-01)),
  (427.0, V(3.4272586140177114e-02, 4.5550021433584081e-02, 6.6966631488015660e-01)),
  (428.0, V(3.6063249338884801e-02, 4.8718875786711170e-02, 6.9984501074435956e-01)),
  (429.0, V(3.7906537803737053e-02, 5.2049648062586502e-02, 7.2919357009983898e-01)),
  (430.0, V(3.9782400323697877e-02, 5.5541584317800263e-02, 7.5690150787601962e-01)),
  (431.0, V(4.1671973629856890e-02, 5.9190999240163251e-02, 7.8230993438229701e-01)),
  (432.0, V(4.3574363290496645e-02, 6.2985510016710239e-02, 8.0568418153451160e-01)),
  (433.0, V(4.5494802991208866e-02, 6.6906989303723144e-02, 8.2761727955486497e-01)),
  (434.0, V(4.7440150175165362e-02, 7.0932543483056124e-02, 8.4879853781219916e-01)),
  (435.0, V(4.9418949745376917e-02, 7.5034181243053430e-02, 8.7000368560217423e-01)),
  (436.0, V(5.1436148077246960e-02, 7.9181434529455891e-02, 8.9178133715669328e-01)),
  (437.0, V(5.3475391990875386e-02, 8.3351095806043218e-02, 9.1346455360568724e-01)),
  (438.0, V(5.5512152216429744e-02, 8.7521014597457480e-02, 9.3399760441058788e-01)),
  (439.0, V(5.7518654469006121e-02, 9.1667730352910523e-02, 9.5223880511639891e-01)),
  (440.0, V(5.9463989152519339e-02, 9.5766670757602201e-02, 9.6698107180997706e-01)),
  (441.0, V(6.1326216388959368e-02, 9.9803411381017074e-02, 9.7736150525212107e-01)),
  (442.0, V(6.3131049090131786e-02, 1.0381042109261525e-01, 9.8405042938837362e-01)),
  (443.0, V(6.4921173069718216e-02, 1.0784012011059561e-01, 9.8816629415569457e-01)),
  (444.0, V(6.6744888840503169e-02, 1.1195476901973585e-01, 9.9087349151536686e-01)),
  (445.0, V(6.8656191817218021e-02, 1.1622681099109643e-01, 9.9335861192361141e-01)),
  (446.0, V(7.0698766748967676e-02, 1.2071337331389528e-01, 9.9639527062895394e-01)),
  (447.0, V(7.2853360753025662e-02, 1.2537059846294771e-01, 9.9906053605371192e-01)),
  (448.0, V(7.5080455328026374e-02, 1.3011839182664620e-01, 1.0000000000000000e+00)),
  (449.0, V(7.7335290486735944e-02, 1.3486392206004044e-01, 9.9786605542157170e-01)),
  (450.0, V(7.9567564245395697e-02, 1.3950135006923295e-01, 9.9135094716071792e-01)),
  (451.0, V(8.1739686371018402e-02, 1.4395148529466881e-01, 9.7967867591575819e-01)),
  (452.0, V(8.3885621368019317e-02, 1.4828985908521655e-01, 9.6392676571116831e-01)),
  (453.0, V(8.6062893076251368e-02, 1.5264598889810280e-01, 9.4559369195695586e-01)),
  (454.0, V(8.8335353459969040e-02, 1.5716636316769209e-01, 9.2609862229488271e-01)),
  (455.0, V(9.0773661124797136e-02, 1.6201541736168543e-01, 9.0675523001460845e-01)),
  (456.0, V(9.3442963780938637e-02, 1.6734065697300651e-01, 8.8852849463131633e-01)),
  (457.0, V(9.6361153962880683e-02, 1.7315399368749454e-01, 8.7137215411354818e-01)),
  (458.0, V(9.9533940773073745e-02, 1.7942763190476219e-01, 8.5501718246310021e-01)),
  (459.0, V(1.0296728932304668e-01, 1.8612769867450657e-01, 8.3921682117824503e-01)),
  (460.0, V(1.0666725552754826e-01, 1.9321274461019641e-01, 8.2374423220140114e-01)),
  (461.0, V(1.1063279814965518e-01, 2.0063242081289315e-01, 8.0832503641501197e-01)),
  (462.0, V(1.1483240107177441e-01, 2.0832668882576252e-01, 7.9244893444144238e-01)),
  (463.0, V(1.1922078168813945e-01, 2.1622466556756939e-01, 7.7558628747186553e-01)),
  (464.0, V(1.2374438909978186e-01, 2.2424366627757325e-01, 7.5726118189531155e-01)),
  (465.0, V(1.2834059308577142e-01, 2.3228860248086503e-01, 7.3705913547048452e-01)),
  (466.0, V(1.3295202261167383e-01, 2.4027129110012768e-01, 7.1474565796919010e-01)),
  (467.0, V(1.3757513055170451e-01, 2.4817429713150593e-01, 6.9057303101629963e-01)),
  (468.0, V(1.4222276436144701e-01, 2.5600133978914102e-01, 6.6490443470927629e-01)),
  (469.0, V(1.4691035458808402e-01, 2.6375901545283270e-01, 6.3809179289461437e-01)),
  (470.0, V(1.5165597187241855e-01, 2.7145678266717560e-01, 6.1046993203760480e-01)),
  (471.0, V(1.5648063195968989e-01, 2.7911266246976701e-01, 5.8235889527392903e-01)),
  (472.0, V(1.6140923673294377e-01, 2.8677190646605860e-01, 5.5407765771545647e-01)),
  (473.0, V(1.6647030020331549e-01, 2.9449263500244555e-01, 5.2591463479269740e-01)),
  (474.0, V(1.7169599751176776e-01, 3.0234067486903693e-01, 4.9811950207241823e-01)),
  (475.0, V(1.7712247093994199e-01, 3.1038990431952102e-01, 4.7090410727797588e-01)),
  (476.0, V(1.8278384169781045e-01, 3.1871005036857009e-01, 4.4446004268111167e-01)),
  (477.0, V(1.8869173919776369e-01, 3.2732604645177654e-01, 4.1900131905340965e-01)),
  (478.0, V(1.9485159963257456e-01, 3.3625137434538072e-01, 3.9470819441390265e-01)),
  (479.0, V(2.0126857218483823e-01, 3.4550010185936475e-01, 3.7171489475529351e-01)),
  (480.0, V(2.0794742602367419e-01, 3.5508686483641666e-01, 3.5011546017430006e-01)),
  (481.0, V(2.1488306396833137e-01, 3.6500598794976818e-01, 3.2991152070726570e-01)),
  (482.0, V(2.2202961739226232e-01, 3.7516388181082305e-01, 3.1087054716971974e-01)),
  (483.0, V(2.2932374504932318e-01, 3.8543251404786133e-01, 2.9274759010026891e-01)),
  (484.0, V(2.3669277836261352e-01, 3.9566828739298321e-01, 2.7534411607241199e-01)),
  (485.0, V(2.4405430940986597e-01, 4.0571173666466193e-01, 2.5850275957752755e-01)),
  (486.0, V(2.5135580632824822e-01, 4.1545881487218389e-01, 2.4216351427771435e-01)),
  (487.0, V(2.5870369489172457e-01, 4.2508864332881696e-01, 2.2650925825042198e-01)),
  (488.0, V(2.6626117388748721e-01, 4.3487564583506022e-01, 2.1173049074302161e-01)),
  (489.0, V(2.7421185882672583e-01, 4.4512265782726967e-01, 1.9796406480678894e-01)),
  (490.0, V(2.8276202102402753e-01, 4.5616348952523639e-01, 1.8530161448479657e-01)),
  (491.0, V(2.9208177851194778e-01, 4.6826290717340635e-01, 1.7375458903231708e-01)),
  (492.0, V(3.0210446592646623e-01, 4.8128305783462094e-01, 1.6315291065729604e-01)),
  (493.0, V(3.1268378107956085e-01, 4.9495582907177049e-01, 1.5331461630268509e-01)),
  (494.0, V(3.2364822788980918e-01, 5.0897657434422094e-01, 1.4408937361667415e-01)),
  (495.0, V(3.3479780226486611e-01, 5.2300005277403849e-01, 1.3535369284593571e-01)),
  (496.0, V(3.4595506091241501e-01, 5.3673148938896453e-01, 1.2701382190017307e-01)),
  (497.0, V(3.5713867349450079e-01, 5.5022619637370862e-01, 1.1901925965341323e-01)),
  (498.0, V(3.6842934687306944e-01, 5.6364831517904312e-01, 1.1133560033854514e-01)),
  (499.0, V(3.7992057636355842e-01, 5.7718304946843924e-01, 1.0393616936083207e-01)),
  (500.0, V(3.9171922175532264e-01, 5.9103690813205945e-01, 9.6801168778859095e-02)),
  (501.0, V(4.0391929038195623e-01, 6.0538449722319665e-01, 8.9918871631161884e-02)),
  (502.0, V(4.1651459202394775e-01, 6.2019589701916256e-01, 8.3289665026371432e-02)),
  (503.0, V(4.2946785435958340e-01, 6.3537962925291347e-01, 7.6917418450761776e-02)),
  (504.0, V(4.4273560584731891e-01, 6.5083325802649739e-01, 7.0806789008167739e-02)),
  (505.0, V(4.5626769070858020e-01, 6.6644269477103679e-01, 6.4962840911500966e-02)),
  (506.0, V(4.7001346414745215e-01, 6.8209389392013020e-01, 5.9406268022151827e-02)),
  (507.0, V(4.8394298310212375e-01, 6.9771168614575330e-01, 5.4208771438767997e-02)),
  (508.0, V(4.9802990263837743e-01, 7.1322750750019936e-01, 4.9429156772479402e-02)),
  (509.0, V(5.1224519472685026e-01, 7.2856792875563392e-01, 4.5100257155333535e-02)),
  (510.0, V(5.2655710024133162e-01, 7.4365483741457383e-01, 4.1234668168161473e-02)),
  (511.0, V(5.4094265836760835e-01, 7.5843956667493040e-01, 3.7815088025202614e-02)),
  (512.0, V(5.5542525993514247e-01, 7.7301065963474969e-01, 3.4763472886391478e-02)),
  (513.0, V(5.7004505336763744e-01, 7.8750263103898732e-01, 3.2003645453279030e-02)),
  (514.0, V(5.8484837630827224e-01, 8.0206346940837814e-01, 2.9475223279578241e-02)),
  (515.0, V(5.9988815263378048e-01, 8.1685492105578961e-01, 2.7130602903922347e-02)),
  (516.0, V(6.1518389203599544e-01, 8.3196695016108946e-01, 2.4938201222134450e-02)),
  (517.0, V(6.3059114639264224e-01, 8.4714480905667111e-01, 2.2893565034926022e-02)),
  (518.0, V(6.4590618647927867e-01, 8.6202197363917621e-01, 2.0996106929200096e-02)),
  (519.0, V(6.6090369330586829e-01, 8.7620280312879573e-01, 1.9243124244698161e-02)),
  (520.0, V(6.7533712712986516e-01, 8.8926473619571589e-01, 1.7630241383861895e-02)),
  (521.0, V(6.8899915059887940e-01, 9.0086433006553213e-01, 1.6150468390843244e-02)),
  (522.0, V(7.0191119647293809e-01, 9.1105824700068749e-01, 1.4791430389731970e-02)),
  (523.0, V(7.1416535001747694e-01, 9.2002100304929257e-01, 1.3541019310566550e-02)),
  (524.0, V(7.2586699496950857e-01, 9.2794365621189367e-01, 1.2388725919033091e-02)),
  (525.0, V(7.3713374149960731e-01, 9.3503067726130462e-01, 1.1325412911406272e-02)),
  (526.0, V(7.4807265640446874e-01, 9.4146820691494948e-01, 1.0343973829240497e-02)),
  (527.0, V(7.5871140166501438e-01, 9.4733327460795203e-01, 9.4411297794295621e-03)),
  (528.0, V(7.6905889359742585e-01, 9.5267711429020951e-01, 8.6138387141479703e-03)),
  (529.0, V(7.7912640960161084e-01, 9.5755324904342021e-01, 7.8584834827477319e-03)),
  (530.0, V(7.8892752515896969e-01, 9.6201705205580623e-01, 7.1710542958265799e-03)),
  (531.0, V(7.9849999260823779e-01, 9.6613604721519053e-01, 6.5466228035020273e-03)),
  (532.0, V(8.0797345154656530e-01, 9.7002199895663388e-01, 5.9778984332234672e-03)),
  (533.0, V(8.1750708661879856e-01, 9.7379946845199505e-01, 5.4580600229062713e-03)),
  (534.0, V(8.2726825075944022e-01, 9.7759507099140253e-01, 4.9813644845025460e-03)),
  (535.0, V(8.3743283820587555e-01, 9.8153741697985741e-01, 4.5429741301512058e-03)),
  (536.0, V(8.4810857277809926e-01, 9.8568539980826475e-01, 4.1391677068831926e-03)),
  (537.0, V(8.5909464535521896e-01, 9.8981056032263159e-01, 3.7680285919654867e-03)),
  (538.0, V(8.7009841155977230e-01, 9.9360856800051978e-01, 3.4279030385261471e-03)),
  (539.0, V(8.8081001540395620e-01, 9.9677121009596370e-01, 3.1170287272725031e-03)),
  (540.0, V(8.9090291130813792e-01, 9.9898824874639802e-01, 2.8335819775437716e-03)),
  (541.0, V(9.0008894605411593e-01, 1.0000000000000000e+00, 2.5756201260263298e-03)),
  (542.0, V(9.0828543970997755e-01, 9.9974956358062228e-01, 2.3408932825566280e-03)),
  (543.0, V(9.1546567632834830e-01, 9.9823546040310362e-01, 2.1272646094917334e-03)),
  (544.0, V(9.2160730811675318e-01, 9.9546210272148838e-01, 1.9328040437989608e-03)),
  (545.0, V(9.2669258444573699e-01, 9.9143972612511111e-01, 1.7557669765805100e-03)),
  (546.0, V(9.3077658426845467e-01, 9.8625590165604959e-01, 1.5945835028337793e-03)),
  (547.0, V(9.3419310842181769e-01, 9.8028507387369834e-01, 1.4478604714970725e-03)),
  (548.0, V(9.3735164342662747e-01, 9.7396255584207769e-01, 1.3143323543541726e-03)),
  (549.0, V(9.4066732600404734e-01, 9.6770916379052352e-01, 1.1928414555930939e-03)),
  (550.0, V(9.4456066806585026e-01, 9.6193090909595302e-01, 1.0823289616065279e-03)),
  (551.0, V(9.4932419098513654e-01, 9.5687531901024259e-01, 9.8184096212609157e-04)),
  (552.0, V(9.5471351309588781e-01, 9.5220596416279857e-01, 8.9055289876743100e-04)),
  (553.0, V(9.6034324473180144e-01, 9.4745295449876110e-01, 8.0770484758728184e-04)),
  (554.0, V(9.6581897590670451e-01, 9.4215942771336936e-01, 7.3258451370431757e-04)),
  (555.0, V(9.7073696830363299e-01, 9.3588294333222821e-01, 6.6452685929085475e-04)),
  (556.0, V(9.7479047304496458e-01, 9.2832725229820556e-01, 6.0289996025751386e-04)),
  (557.0, V(9.7808960403544876e-01, 9.1971986271053519e-01, 5.4707377355685532e-04)),
  (558.0, V(9.8085357904876658e-01, 9.1040884260993094e-01, 4.9647220334424582e-04)),
  (559.0, V(9.8330539899275360e-01, 9.0072908127831264e-01, 4.5058098815371186e-04)),
  (560.0, V(9.8567068786826251e-01, 8.9100037412854116e-01, 4.0894052673798417e-04)),
  (561.0, V(9.8811982671717524e-01, 8.8143650646973304e-01, 3.7114448403741612e-04)),
  (562.0, V(9.9059502149005696e-01, 8.7188378245254228e-01, 3.3684534530381891e-04)),
  (563.0, V(9.9298046608030766e-01, 8.6210829960956659e-01, 3.0572968354902438e-04)),
  (564.0, V(9.9515944634912701e-01, 8.5188875219868532e-01, 2.7751024436840845e-04)),
  (565.0, V(9.9701456113335230e-01, 8.4101719224687788e-01, 2.5192404589852732e-04)),
  (566.0, V(9.9844607889640369e-01, 8.2935083153282707e-01, 2.2872968375702905e-04)),
  (567.0, V(9.9942652466399107e-01, 8.1695830500832745e-01, 2.0770356795875121e-04)),
  (568.0, V(9.9994714512571325e-01, 8.0395660940969993e-01, 1.8864200096205348e-04)),
  (569.0, V(1.0000000000000000e+00, 7.9045819521150573e-01, 1.7136034865033352e-04)),
  (570.0, V(9.9957801603602658e-01, 7.7657033659026986e-01, 1.5569127329262934e-04)),
  (571.0, V(9.9865002812864745e-01, 7.6235446708315124e-01, 1.4148323251015206e-04)),
  (572.0, V(9.9708644268234392e-01, 7.4771224202775921e-01, 1.2859922424830387e-04)),
  (573.0, V(9.9473582432706642e-01, 7.3251835620939554e-01, 1.1691509473895229e-04)),
  (574.0, V(9.9145129485436678e-01, 7.1666313131311166e-01, 1.0631826147195778e-04)),
  (575.0, V(9.8709206527172655e-01, 7.0005336397253748e-01, 9.6706659371677354e-05)),
  (576.0, V(9.8163352770652590e-01, 6.8268663204821345e-01, 8.7987721574240215e-05)),
  (577.0, V(9.7548607571173085e-01, 6.6485514936493495e-01, 8.0077389305471960e-05)),
  (578.0, V(9.6915483819971737e-01, 6.4689513228103135e-01, 7.2899509567465325e-05)),
  (579.0, V(9.6312737445982577e-01, 6.2910842117556598e-01, 6.6385143423157759e-05)),
  (580.0, V(9.5787457819041710e-01, 6.1176322149100382e-01, 6.0471884681140856e-05)),
  (581.0, V(9.5369768407357491e-01, 5.9503186914993000e-01, 5.5103229981615672e-05)),
  (582.0, V(9.5027012852902770e-01, 5.7881609649438781e-01, 5.0227992883329324e-05)),
  (583.0, V(9.4712000882263281e-01, 5.6296717196085999e-01, 4.5799842553289575e-05)),
  (584.0, V(9.4378559458096944e-01, 5.4735272092761289e-01, 4.1776852356700148e-05)),
  (585.0, V(9.3981478177197642e-01, 5.3185570765607970e-01, 3.8121079747594057e-05)),
  (586.0, V(9.3485936704801487e-01, 5.1638408884668352e-01, 3.4798175660124516e-05)),
  (587.0, V(9.2894962748274013e-01, 5.0089873124624895e-01, 3.1777018100395563e-05)),
  (588.0, V(9.2220931546453566e-01, 4.8537751858138733e-01, 2.9029439140375074e-05)),
  (589.0, V(9.1476103434103873e-01, 4.6980420391664890e-01, 2.6529950811783300e-05)),
  (590.0, V(9.0672516638112510e-01, 4.5416826264605836e-01, 2.4255486800333700e-05)),
  (591.0, V(8.9820178213339619e-01, 4.3847877629250254e-01, 2.2185164640430824e-05)),
  (592.0, V(8.8921972762076118e-01, 4.2280205667401710e-01, 2.0300062810200416e-05)),
  (593.0, V(8.7979040024738320e-01, 4.0721191604048990e-01, 1.8583051627719093e-05)),
  (594.0, V(8.6992528042036898e-01, 3.9177461420696219e-01, 1.7018624747257364e-05)),
  (595.0, V(8.5963595255051339e-01, 3.7654903456376304e-01, 1.5592743355805861e-05)),
  (596.0, V(8.4894202533316032e-01, 3.6157939565686370e-01, 1.4292690869835635e-05)),
  (597.0, V(8.3789445757535996e-01, 3.4687564705913071e-01, 1.3106938132292598e-05)),
  (598.0, V(8.2655111332902975e-01, 3.3244082494537786e-01, 1.2025041010314366e-05)),
  (599.0, V(8.1496852359881533e-01, 3.1827906855393012e-01, 1.1037538692962699e-05)),
  (600.0, V(8.0320167333453807e-01, 3.0439542017510740e-01, 1.0135858789107563e-05)),
  (601.0, V(7.9128092961304497e-01, 2.9080042441603660e-01, 9.3122303354875606e-06)),
  (602.0, V(7.7914584629085526e-01, 2.7752241490808316e-01, 8.5596026749012400e-06)),
  (603.0, V(7.6671843160230302e-01, 2.6458986329055867e-01, 7.8715824748028584e-06)),
  (604.0, V(7.5392693600307759e-01, 2.5202640792448905e-01, 7.2423724059351634e-06)),
  (605.0, V(7.4070616918146526e-01, 2.3985117491109784e-01, 6.6667139910551449e-06)),
  (606.0, V(7.2702074388259874e-01, 2.2807830406451313e-01, 6.1398347237550010e-06)),
  (607.0, V(7.1293048822804306e-01, 2.1671520681146259e-01, 5.6573984073548899e-06)),
  (608.0, V(6.9851566006382149e-01, 2.0576595838658601e-01, 5.2154684240839834e-06)),
  (609.0, V(6.8385288010698153e-01, 1.9523240489617671e-01, 4.8104709542603960e-06)),
  (610.0, V(6.6901483693513253e-01, 1.8511434732877613e-01, 4.4391604255208479e-06)),
  (611.0, V(6.5405976061317106e-01, 1.7540783045665420e-01, 4.0985883021247842e-06)),
  (612.0, V(6.3900215765551260e-01, 1.6610044156512399e-01, 3.7860750043282964e-06)),
  (613.0, V(6.2384691823556748e-01, 1.5717843986303198e-01, 3.4991844678168946e-06)),
  (614.0, V(6.0860008956777611e-01, 1.4862880460068251e-01, 3.2357012531951411e-06)),
  (615.0, V(5.9326887390753758e-01, 1.4043916406574938e-01, 2.9936098255246700e-06)),
  (616.0, V(5.7787768312052112e-01, 1.3259857662824651e-01, 0.0000000000000000e+00)),
  (617.0, V(5.6251276626520452e-01, 1.2509960185977628e-01, 0.0000000000000000e+00)),
  (618.0, V(5.4726787766620988e-01, 1.1793515135220940e-01, 0.0000000000000000e+00)),
  (619.0, V(5.3222750631960158e-01, 1.1109761666747486e-01, 0.0000000000000000e+00)),
  (620.0, V(5.1746717590352465e-01, 1.0457894534193594e-01, 0.0000000000000000e+00)),
  (621.0, V(5.0301043325297357e-01, 9.8371987463922214e-02, 0.0000000000000000e+00)),
  (622.0, V(4.8870935312237102e-01, 9.2473822665287586e-02, 0.0000000000000000e+00)),
  (623.0, V(4.7439279944306101e-01, 8.6880945144178559e-02, 0.0000000000000000e+00)),
  (624.0, V(4.5991196493818864e-01, 8.1588093197642042e-02, 0.0000000000000000e+00)),
  (625.0, V(4.4514036212238123e-01, 7.6588522237344858e-02, 0.0000000000000000e+00)),
  (626.0, V(4.3002204701180907e-01, 7.1872414598015313e-02, 0.0000000000000000e+00)),
  (627.0, V(4.1470133272395970e-01, 6.7422497085114663e-02, 0.0000000000000000e+00)),
  (628.0, V(3.9935398749175044e-01, 6.3221206587411691e-02, 0.0000000000000000e+00)),
  (629.0, V(3.8413544582704445e-01, 5.9252598686874595e-02, 0.0000000000000000e+00)),
  (630.0, V(3.6918104252894912e-01, 5.5502181549107049e-02, 0.0000000000000000e+00)),
  (631.0, V(3.5459255020642289e-01, 5.1957942282442798e-02, 0.0000000000000000e+00)),
  (632.0, V(3.4040142197482465e-01, 4.8613134298433502e-02, 0.0000000000000000e+00)),
  (633.0, V(3.2662054729122747e-01, 4.5461679747134796e-02, 0.0000000000000000e+00)),
  (634.0, V(3.1325992051004120e-01, 4.2496963247652911e-02, 0.0000000000000000e+00)),
  (635.0, V(3.0032684889038852e-01, 3.9711955395255794e-02, 0.0000000000000000e+00)),
  (636.0, V(2.8782767665724196e-01, 3.7097343853767069e-02, 0.0000000000000000e+00)),
  (637.0, V(2.7577196814976251e-01, 3.4636743079756296e-02, 0.0000000000000000e+00)),
  (638.0, V(2.6416726863551304e-01, 3.2314345763085998e-02, 0.0000000000000000e+00)),
  (639.0, V(2.5301782226499536e-01, 3.0116827236561800e-02, 0.0000000000000000e+00)),
  (640.0, V(2.4232495308516136e-01, 2.8033033357961649e-02, 0.0000000000000000e+00)),
  (641.0, V(2.3206963142119982e-01, 2.6057913936510725e-02, 0.0000000000000000e+00)),
  (642.0, V(2.2216564321587406e-01, 2.4202485506508008e-02, 0.0000000000000000e+00)),
  (643.0, V(2.1252327628790044e-01, 2.2477249572598643e-02, 0.0000000000000000e+00)),
  (644.0, V(2.0306747897587196e-01, 2.0888210780512111e-02, 0.0000000000000000e+00)),
  (645.0, V(1.9373690410435643e-01, 1.9437755167629286e-02, 0.0000000000000000e+00)),
  (646.0, V(1.8450132860161353e-01, 1.8121058656194247e-02, 0.0000000000000000e+00)),
  (647.0, V(1.7540818314958265e-01, 1.6915904067008464e-02, 0.0000000000000000e+00)),
  (648.0, V(1.6651521179592549e-01, 1.5799986115800590e-02, 0.0000000000000000e+00)),
  (649.0, V(1.5787083025751175e-01, 1.4755156357637604e-02, 0.0000000000000000e+00)),
  (650.0, V(1.4951464293875324e-01, 1.3766781549981302e-02, 0.0000000000000000e+00)),
  (651.0, V(1.4147537385823236e-01, 1.2825330244039462e-02, 0.0000000000000000e+00)),
  (652.0, V(1.3376465542844615e-01, 1.1931049054011381e-02, 0.0000000000000000e+00)),
  (653.0, V(1.2638774983599693e-01, 1.1085597275434327e-02, 0.0000000000000000e+00)),
  (654.0, V(1.1934691116081667e-01, 1.0289787155075027e-02, 0.0000000000000000e+00)),
  (655.0, V(1.1264174138879138e-01, 9.5437029977875031e-03, 0.0000000000000000e+00)),
  (656.0, V(1.0626768135824864e-01, 8.8465974705425627e-03, 0.0000000000000000e+00)),
  (657.0, V(1.0021164060498750e-01, 8.1964703081709323e-03, 0.0000000000000000e+00)),
  (658.0, V(9.4459184917156339e-02, 7.5910239383852997e-03, 0.0000000000000000e+00)),
  (659.0, V(8.8996564707181078e-02, 7.0279453680104544e-03, 0.0000000000000000e+00)),
  (660.0, V(8.3810675510364266e-02, 6.5049289442938255e-03, 0.0000000000000000e+00)),
  (661.0, V(7.8889290293123082e-02, 6.0198636356885524e-03, 0.0000000000000000e+00)),
  (662.0, V(7.4221712576149665e-02, 5.5712526760153267e-03, 0.0000000000000000e+00)),
  (663.0, V(6.9797721096987828e-02, 5.1575738976323039e-03, 0.0000000000000000e+00)),
  (664.0, V(6.5607280099759621e-02, 4.7771486738891963e-03, 0.0000000000000000e+00)),
  (665.0, V(6.1640554335697297e-02, 4.4281981323638676e-03, 0.0000000000000000e+00)),
  (666.0, V(5.7887723856575674e-02, 4.1085596385383085e-03, 0.0000000000000000e+00)),
  (667.0, V(5.4338495997406568e-02, 3.8149216917462456e-03, 0.0000000000000000e+00)),
  (668.0, V(5.0982865603397161e-02, 3.5441276702388694e-03, 0.0000000000000000e+00)),
  (669.0, V(4.7811311836929042e-02, 3.2934798486892480e-03, 0.0000000000000000e+00)),
  (670.0, V(4.4814771076597142e-02, 3.0606722243246595e-03, 0.0000000000000000e+00)),
  (671.0, V(4.1984591515599731e-02, 2.8438583708334172e-03, 0.0000000000000000e+00)),
  (672.0, V(3.9312460959178071e-02, 2.6419057230058132e-03, 0.0000000000000000e+00)),
  (673.0, V(3.6790459826495904e-02, 2.4538764068418764e-03, 0.0000000000000000e+00)),
  (674.0, V(3.4411058650550802e-02, 2.2788822412028020e-03, 0.0000000000000000e+00)),
  (675.0, V(3.2167095277365630e-02, 2.1160831077170930e-03, 0.0000000000000000e+00)),
  (676.0, V(3.0051999973971073e-02, 1.9646778202548568e-03, 0.0000000000000000e+00)),
  (677.0, V(2.8060381849200754e-02, 1.8238840137698607e-03, 0.0000000000000000e+00)),
  (678.0, V(2.6187071319736070e-02, 1.6929656458829930e-03, 0.0000000000000000e+00)),
  (679.0, V(2.4426876601471165e-02, 1.5712378671626777e-03, 0.0000000000000000e+00)),
  (680.0, V(2.2774617610715090e-02, 1.4580633409129798e-03, 0.0000000000000000e+00)),
  (681.0, V(2.1224506942240678e-02, 1.3528205213471575e-03, 0.0000000000000000e+00)),
  (682.0, V(1.9768584013757712e-02, 1.2548315694372735e-03, 0.0000000000000000e+00)),
  (683.0, V(1.8399235055274295e-02, 1.1634698791052292e-03, 0.0000000000000000e+00)),
  (684.0, V(1.7109805530813926e-02, 1.0781825585171718e-03, 0.0000000000000000e+00)),
  (685.0, V(1.5894480934188406e-02, 9.9848123055381157e-04, 0.0000000000000000e+00)),
  (686.0, V(1.4749709039432245e-02, 9.2401557504476434e-04, 0.0000000000000000e+00)),
  (687.0, V(1.3677795028289497e-02, 8.5476192862756449e-04, 0.0000000000000000e+00)),
  (688.0, V(1.2680865376167104e-02, 7.9069790701339206e-04, 0.0000000000000000e+00)),
  (689.0, V(1.1759434501306849e-02, 7.3172618259841548e-04, 0.0000000000000000e+00)),
  (690.0, V(1.0912726376190026e-02, 6.7769180446102537e-04, 0.0000000000000000e+00)),
  (691.0, V(1.0137673692046795e-02, 6.2833350655830704e-04, 0.0000000000000000e+00)),
  (692.0, V(9.4260147159078416e-03, 5.8314150853863711e-04, 0.0000000000000000e+00)),
  (693.0, V(8.7694765544080958e-03, 5.4161479155485329e-04, 0.0000000000000000e+00)),
  (694.0, V(8.1610495189769934e-03, 5.0332323384183486e-04, 0.0000000000000000e+00)),
  (695.0, V(7.5947974991141158e-03, 4.6789717311553644e-04, 0.0000000000000000e+00)),
  (696.0, V(7.0661347922058660e-03, 4.3503199883739702e-04, 0.0000000000000000e+00)),
  (697.0, V(6.5727525563784011e-03, 4.0451329966225465e-04, 0.0000000000000000e+00)),
  (698.0, V(6.1128397874117011e-03, 3.7615946013323608e-04, 0.0000000000000000e+00)),
  (699.0, V(5.6845989115620029e-03, 3.4980459769932168e-04, 0.0000000000000000e+00)),
  (700.0, V(5.2862590960338039e-03, 3.2529706362903254e-04, 0.0000000000000000e+00)),
  (701.0, V(4.9159019727998575e-03, 3.0249439671987998e-04, 0.0000000000000000e+00)),
  (702.0, V(4.5710185228878394e-03, 2.8125311371052811e-04, 0.0000000000000000e+00)),
  (703.0, V(4.2492299119419076e-03, 2.6144184703722688e-04, 0.0000000000000000e+00)),
  (704.0, V(3.9484573462459554e-03, 2.4294366296728266e-04, 0.0000000000000000e+00)),
  (705.0, V(3.6668837613650618e-03, 2.2565434650030844e-04, 0.0000000000000000e+00)),
  (706.0, V(3.4030888769346649e-03, 2.0949048783381802e-04, 0.0000000000000000e+00)),
  (707.0, V(3.1564273800713250e-03, 1.9441139262475315e-04, 0.0000000000000000e+00)),
  (708.0, V(2.9263486112481030e-03, 1.8038071278029974e-04, 0.0000000000000000e+00)),
  (709.0, V(2.7122233581525035e-03, 1.6735691490908972e-04, 0.0000000000000000e+00)),
  (710.0, V(2.5133637963935841e-03, 1.5529468540210139e-04, 0.0000000000000000e+00)),
  (711.0, V(2.3290327198292778e-03, 1.4414290231588663e-04, 0.0000000000000000e+00)),
  (712.0, V(2.1584386903944000e-03, 1.3383778597820324e-04, 0.0000000000000000e+00)),
  (713.0, V(2.0007818497251731e-03, 1.2431636376327641e-04, 0.0000000000000000e+00)),
  (714.0, V(1.8552722798103143e-03, 1.1551999929499940e-04, 0.0000000000000000e+00)),
  (715.0, V(1.7211371032428179e-03, 1.0739415543328738e-04, 0.0000000000000000e+00)),
  (716.0, V(1.5975533008376007e-03, 9.9885789424097662e-05, 0.0000000000000000e+00)),
  (717.0, V(1.4834750755096525e-03, 9.2937368254851995e-05, 0.0000000000000000e+00)),
  (718.0, V(1.3779176423375148e-03, 8.6495676261552106e-05, 0.0000000000000000e+00)),
  (719.0, V(1.2800221808665557e-03, 8.0513656934825338e-05, 0.0000000000000000e+00)),
  (720.0, V(1.1890389245093021e-03, 7.4949647475852722e-05, 0.0000000000000000e+00)),
  (721.0, V(1.1043653619000982e-03, 6.9769224402633427e-05, 0.0000000000000000e+00)),
  (722.0, V(1.0256615009824864e-03, 6.4950764670177404e-05, 0.0000000000000000e+00)),
  (723.0, V(9.5263605742723233e-04, 6.0475314887205259e-05, 0.0000000000000000e+00)),
  (724.0, V(8.8499082865977502e-04, 5.6323927362765765e-05, 0.0000000000000000e+00)),
  (725.0, V(8.2242523802136542e-04, 5.2477853817389240e-05, 0.0000000000000000e+00)),
  (726.0, V(7.6461247792307960e-04, 4.8917058197459831e-05, 0.0000000000000000e+00)),
  (727.0, V(7.1113512456265208e-04, 4.5616289549103368e-05, 0.0000000000000000e+00)),
  (728.0, V(6.6159384777943610e-04, 4.2551466385780093e-05, 0.0000000000000000e+00)),
  (729.0, V(6.1563336397471992e-04, 3.9701201176060116e-05, 0.0000000000000000e+00)),
  (730.0, V(5.7293715492445080e-04, 3.7046475124898264e-05, 0.0000000000000000e+00)),
  (731.0, V(5.3322459067720995e-04, 3.4570746279858558e-05, 0.0000000000000000e+00)),
  (732.0, V(4.9625115556222745e-04, 3.2260664572284078e-05, 0.0000000000000000e+00)),
  (733.0, V(4.6179828582901380e-04, 3.0104368919249264e-05, 0.0000000000000000e+00)),
  (734.0, V(4.2966875548373820e-04, 2.8090946892449226e-05, 0.0000000000000000e+00)),
  (735.0, V(3.9968435520692001e-04, 2.6210350813368780e-05, 0.0000000000000000e+00)),
  (736.0, V(3.7170278795256356e-04, 2.4454355108404077e-05, 0.0000000000000000e+00)),
  (737.0, V(3.4566202952122883e-04, 2.2819033151471761e-05, 0.0000000000000000e+00)),
  (738.0, V(3.2150574791532682e-04, 2.1300754033514985e-05, 0.0000000000000000e+00)),
  (739.0, V(2.9916517569629535e-04, 1.9895208606425931e-05, 0.0000000000000000e+00)),
  (740.0, V(2.7856245810332680e-04, 1.8597598593934242e-05, 0.0000000000000000e+00)),
  (741.0, V(2.5959196339061380e-04, 1.7401271513009905e-05, 0.0000000000000000e+00)),
  (742.0, V(2.4206957702927105e-04, 1.6294048462428322e-05, 0.0000000000000000e+00)),
  (743.0, V(2.2581694469467581e-04, 1.5264089960507656e-05, 0.0000000000000000e+00)),
  (744.0, V(2.1068190099089105e-04, 1.4301339428220259e-05, 0.0000000000000000e+00)),
  (745.0, V(1.9653475331888744e-04, 1.3397272174740005e-05, 0.0000000000000000e+00)),
  (746.0, V(1.8327780621428617e-04, 1.2545649840880887e-05, 0.0000000000000000e+00)),
  (747.0, V(1.7087378335523155e-04, 1.1744739126844706e-05, 0.0000000000000000e+00)),
  (748.0, V(1.5929516876597960e-04, 1.0993515173623152e-05, 0.0000000000000000e+00)),
  (749.0, V(1.4851077334053343e-04, 1.0290639204133456e-05, 0.0000000000000000e+00)),
  (750.0, V(1.3848670087689979e-04, 9.6345238869818402e-06, 0.0000000000000000e+00)),
  (751.0, V(1.2918333897038323e-04, 9.0231474357599083e-06, 0.0000000000000000e+00)),
  (752.0, V(1.2054655970155357e-04, 8.4534935667990953e-06, 0.0000000000000000e+00)),
  (753.0, V(1.1252306918055620e-04, 7.9225219050437265e-06, 0.0000000000000000e+00)),
  (754.0, V(1.0506433068623046e-04, 7.4274269889637434e-06, 0.0000000000000000e+00)),
  (755.0, V(9.8126104949807622e-05, 6.9656191594543438e-06, 0.0000000000000000e+00)),
  (756.0, V(9.1667393517441521e-05, 6.5345950623799063e-06, 0.0000000000000000e+00)),
  (757.0, V(8.5648487481014570e-05, 6.1316406914760929e-06, 0.0000000000000000e+00)),
  (758.0, V(8.0033058352282219e-05, 5.7542374317286066e-06, 0.0000000000000000e+00)),
  (759.0, V(7.4788433672646462e-05, 5.4001512145064773e-06, 0.0000000000000000e+00)),
  (760.0, V(6.9885194598885670e-05, 5.0673993056498211e-06, 0.0000000000000000e+00)),
  (761.0, V(6.5298904064437025e-05, 4.7544064044575499e-06, 0.0000000000000000e+00)),
  (762.0, V(6.1014945250973539e-05, 4.4604428989207918e-06, 0.0000000000000000e+00)),
  (763.0, V(5.7020322897670271e-05, 4.1849051342829164e-06, 0.0000000000000000e+00)),
  (764.0, V(5.3301536125772551e-05, 3.9271242820347866e-06, 0.0000000000000000e+00)),
  (765.0, V(4.9844802546543103e-05, 3.6863835009028315e-06, 0.0000000000000000e+00)),
  (766.0, V(4.6633834782415216e-05, 3.4617651480519293e-06, 0.0000000000000000e+00)),
  (767.0, V(4.3643992859630796e-05, 3.2517415655241182e-06, 0.0000000000000000e+00)),
  (768.0, V(4.0851538536408033e-05, 3.0548143970485388e-06, 0.0000000000000000e+00)),
  (769.0, V(3.8235912083678395e-05, 2.8696773374120562e-06, 0.0000000000000000e+00)),
  (770.0, V(3.5779320670490294e-05, 2.6951925110992118e-06, 0.0000000000000000e+00)),
  (771.0, V(3.3468793936901796e-05, 2.5305413709805170e-06, 0.0000000000000000e+00)),
  (772.0, V(3.1301854795072890e-05, 2.3756367420366958e-06, 0.0000000000000000e+00)),
  (773.0, V(2.9277100195250020e-05, 2.2304627733551012e-06, 0.0000000000000000e+00)),
  (774.0, V(2.7391761339248853e-05, 2.0949018881660148e-06, 0.0000000000000000e+00)),
  (775.0, V(2.5641989290582231e-05, 1.9687545149787089e-06, 0.0000000000000000e+00)),
  (776.0, V(2.4021370921834255e-05, 1.8516218408307295e-06, 0.0000000000000000e+00)),
  (777.0, V(2.2516805168428078e-05, 1.7425794924994396e-06, 0.0000000000000000e+00)),
  (778.0, V(2.1115227467081209e-05, 1.6406935962151892e-06, 0.0000000000000000e+00)),
  (779.0, V(1.9805321016488566e-05, 1.5451546053667130e-06, 0.0000000000000000e+00)),
  (780.0, V(1.8577285169109381e-05, 1.4552612695781183e-06, 0.0000000000000000e+00)),
  (781.0, V(1.7423404351341702e-05, 1.3704676274145837e-06, 0.0000000000000000e+00)),
  (782.0, V(1.6339794425450120e-05, 1.2905249645558841e-06, 0.0000000000000000e+00)),
  (783.0, V(1.5323374782193150e-05, 1.2152457402039837e-06, 0.0000000000000000e+00)),
  (784.0, V(1.4371032811194517e-05, 1.1444376132844599e-06, 0.0000000000000000e+00)),
  (785.0, V(1.3479652901971556e-05, 1.0779055325668487e-06, 0.0000000000000000e+00)),
  (786.0, V(1.2645897336165437e-05, 1.0154340456460462e-06, 0.0000000000000000e+00)),
  (787.0, V(1.1865612566487219e-05, 9.5673915417027949e-07, 0.0000000000000000e+00)),
  (788.0, V(1.1134768350020460e-05, 9.0154244610941960e-07, 0.0000000000000000e+00)),
  (789.0, V(1.0449696156675411e-05, 8.4959042386783499e-07, 0.0000000000000000e+00)),
  (790.0, V(9.8070531679123872e-06, 8.0065207214435782e-07, 0.0000000000000000e+00)),
  (791.0, V(9.2039556314706471e-06, 7.5453525887660036e-07, 0.0000000000000000e+00)),
  (792.0, V(8.6383638750213729e-06, 7.1113197284560050e-07, 0.0000000000000000e+00)),
  (793.0, V(8.1084365232675512e-06, 6.7034751459884811e-07, 0.0000000000000000e+00)),
  (794.0, V(7.6123554117352554e-06, 6.3208153735867652e-07, 0.0000000000000000e+00)),
  (795.0, V(7.1483360271438585e-06, 5.9622980412343199e-07, 0.0000000000000000e+00)),
  (796.0, V(6.7145588149701373e-06, 5.6267181495508964e-07, 0.0000000000000000e+00)),
  (797.0, V(6.3089815427944892e-06, 5.3123661501058245e-07, 0.0000000000000000e+00)),
  (798.0, V(5.9296342507601658e-06, 5.0175523456114031e-07, 0.0000000000000000e+00)),
  (799.0, V(5.5746943042347220e-06, 4.7407451378828038e-07, 0.0000000000000000e+00)),
  (800.0, V(5.2424745933915561e-06, 4.4805548769081476e-07, 0.0000000000000000e+00)),
  (801.0, V(4.9313270997902858e-06, 4.2356753974823608e-07, 0.0000000000000000e+00)),
  (802.0, V(4.6394164383463201e-06, 4.0047579419480232e-07, 0.0000000000000000e+00)),
  (803.0, V(4.3650305783493387e-06, 3.7865624589066966e-07, 0.0000000000000000e+00)),
  (804.0, V(4.1066522559956501e-06, 3.5799894950551567e-07, 0.0000000000000000e+00)),
  (805.0, V(3.8629367035984463e-06, 3.3840648243003886e-07, 0.0000000000000000e+00)),
  (806.0, V(3.6328311238244817e-06, 3.1980497741118441e-07, 0.0000000000000000e+00)),
  (807.0, V(3.4159079715125777e-06, 3.0217459330655880e-07, 0.0000000000000000e+00)),
  (808.0, V(3.2118291946750723e-06, 2.8550270138903785e-07, 0.0000000000000000e+00)),
  (809.0, V(3.0202023293948027e-06, 2.6977109561037196e-07, 0.0000000000000000e+00)),
  (810.0, V(2.8405925702531340e-06, 2.5495697265761470e-07, 0.0000000000000000e+00)),
  (811.0, V(2.6724837389458668e-06, 2.4102865370679449e-07, 0.0000000000000000e+00)),
  (812.0, V(2.5151620301607514e-06, 2.2793309870402408e-07, 0.0000000000000000e+00)),
  (813.0, V(2.3679095484404971e-06, 2.1561568250415152e-07, 0.0000000000000000e+00)),
  (814.0, V(2.2300569900509241e-06, 2.0402567118606987e-07, 0.0000000000000000e+00)),
  (815.0, V(2.1009803728650022e-06, 1.9311592603567334e-07, 0.0000000000000000e+00)),
  (816.0, V(1.9800668251496865e-06, 1.8283986837110119e-07, 0.0000000000000000e+00)),
  (817.0, V(1.8666324626537581e-06, 1.7314410311802523e-07, 0.0000000000000000e+00)),
  (818.0, V(1.7600352326093834e-06, 1.6397830937911911e-07, 0.0000000000000000e+00)),
  (819.0, V(1.6597013646700925e-06, 1.5529765457305734e-07, 0.0000000000000000e+00)),
  (820.0, V(1.5651178606444564e-06, 1.4706220740071552e-07, 0.0000000000000000e+00)),
  (821.0, V(1.4758567953578202e-06, 1.3923950299286382e-07, 0.0000000000000000e+00)),
  (822.0, V(1.3916481892364384e-06, 1.3181201134017693e-07, 0.0000000000000000e+00)),
  (823.0, V(1.3122599040484572e-06, 1.2476541161810472e-07, 0.0000000000000000e+00)),
  (824.0, V(1.2374638517056452e-06, 1.1808525299461167e-07, 0.0000000000000000e+00)),
  (825.0, V(1.1670367742910530e-06, 1.1175704763553172e-07, 0.0000000000000000e+00)),
  (826.0, V(1.1007609540841927e-06, 1.0576635170923236e-07, 0.0000000000000000e+00)),
  (827.0, V(1.0384247735808959e-06, 1.0009883639070286e-07, 0.0000000000000000e+00)),
  (828.0, V(9.7982319151019407e-07, 9.4740349565106907e-08, 0.0000000000000000e+00)),
  (829.0, V(9.2475807384605661e-07, 8.9676972931070455e-08, 0.0000000000000000e+00)),
  (830.0, V(8.7303848881785193e-07, 8.4895065603192243e-08, 0.0000000000000000e+00)) )

lms2018=lms_10deg_rectified # to be adjusted further

lms=Interpolant(lms2018,V(0.0,0.0,0.0))

if __name__=="__main__": # this code calculates rectifications per discussion
  print
  print "\nStep 1: Renormalize CIE-LMS 2006 to unity"
  lms_o=cie_lms_2006_10deg # _o => old; _n => new
  m_lms_xyz_o=cie_lms_10deg_to_xyz
  peaks=V([0.999964539,0.999942423,0.999977704])
  lms_n=tuple( ((w,V([e/f for e,f in zip(v,peaks)])) for w,v in lms_o) )
  print
  print "\nStep 2: Adjust matrix"
  m_lms_xyz_n = SqM(V([e*f for e,f in zip(v,peaks)]) for v in m_lms_xyz_o)
  print "  New lms to XYZ:"
  print repr(m_lms_xyz_n)
  # Verify data identity
  xyz_o=tuple( ((w,m_lms_xyz_o|v) for w,v in lms_o) )
  xyz_n=tuple( ((w,m_lms_xyz_n|v) for w,v in lms_n) )
  diffs=map(abs,[u[1]-v[1] for u,v in zip(xyz_n,xyz_o)])
  nonzero=[v for v in diffs if v!=0.0]
  mxd,mnd = max(diffs),min(diffs)
  half=[v for v in nonzero if v<mxd/2.0]
  print "  Maximum deviation of new xyz from old xyz: {:e}".format(mxd)
  print "  Minimum deviation of new xyz from old xyz: {:e}".format(mnd)
  print "  # deviations != 0.0: {}; # deviations: {}; ratio: {:f}".format( \
    len(nonzero),len(diffs),float(len(nonzero))/float(len(diffs)) )
  print "  # deviations < half max deviation: {}; # nonzero: {}; ratio: {:f}".format( \
    len(half),len(nonzero),float(len(half))/float(len(nonzero)) )
  print
  print "\nStep 3: Rectify XYZ data to exact 1/3 integrals"
  xyz_swi_o=sum([v for w,v in xyz_o],V(0.,0.,0.)) # _swi => step-wise integral
  xyz_swi_n=sum([v for w,v in xyz_n],V(0.,0.,0.))
  print "  old stepwise integrals:\n    ",repr(xyz_swi_o)
  print "  new stepwise integrals:\n    ",repr(xyz_swi_n)
  sum_o=sum(xyz_swi_o)
  sum_n=sum(xyz_swi_n)
  print "  old,new sums:",repr(sum_o),repr(sum_n),"== 355.5542724881515"
  print "  normalized old stepwise integrals:\n    ",repr(xyz_swi_o/sum_o)
  print "  normalized new stepwise integrals:\n    ",repr(xyz_swi_n/sum_n)
  print
  factors=V(sum_n/(e*3.0) for e in xyz_swi_n)
  rectified_integrals=V(a*b for a,b in zip(factors,xyz_swi_n))
  print "  xyz normalizing factors:\n    ",repr(factors)
  print "  rectified new stepwise integrals:\n    ",repr(rectified_integrals)
  mean_integral=sum(rectified_integrals)/3.0
  print "  mean rectified stepwise integral:",repr(mean_integral)
  xyz_r=tuple( ((w,V([e*f for e,f in zip(v,factors)])) \
    for w,v in xyz_n) )
  xyz_swi_r=sum([v for w,v in xyz_r],V(0.,0.,0.))
  sum_r=sum(xyz_swi_r)
  print "  rectified new stepwise integrals:\n  ",repr(xyz_swi_r)
  print "  normalized & rectified new stepwise integrals:\n  ", \
    repr(xyz_swi_r/sum_r)
  print "  new rectified sum:",repr(sum_r)
  print
  print "\nStep 4: Readjust matrix again"
  m_lms_xyz_ri = SqM(V([e/f for e,f in zip(v,factors)]) for v in m_lms_xyz_n.inverse)
  m_lms_xyz_r=m_lms_xyz_ri.inverse
  print "  final lms to XYZ:"
  print repr(m_lms_xyz_r)
  print
  print "\nStep 5: Verify normalized lms fidelity"
  lms_r=tuple( ((w,m_lms_xyz_ri|v) for w,v in xyz_r) )
  diffs=map(abs,[u[1]-v[1] for u,v in zip(lms_r,lms_n)])
  nonzero=[v for v in diffs if v!=0.0]
  mxd,mnd = max(diffs),min(diffs)
  half=[v for v in nonzero if v<mxd/2.0]
  print "  Maximum deviation of rectified lms from new lms: {:e}".format(mxd)
  print "  Minimum deviation of rectified lms from new lms: {:e}".format(mnd)
  print "  # deviations != 0.0: {}; # deviations: {}; ratio: {:f}".format( \
    len(nonzero),len(diffs),float(len(nonzero))/float(len(diffs)) )
  print "  # deviations < half max deviation: {}; # nonzero: {}; ratio: {:f}".format( \
    len(half),len(nonzero),float(len(half))/float(len(nonzero)) )
  print
  #for t in lms_r: print t
  # map forward and verify XYZ fidelity
  xyz_f=tuple( ((w,m_lms_xyz_r|v) for w,v in lms_n) )
  diffs=map(abs,[u[1]-v[1] for u,v in zip(xyz_r,xyz_f)])
  nonzero=[v for v in diffs if v!=0.0]
  mxd,mnd = max(diffs),min(diffs)
  half=[v for v in nonzero if v<mxd/2.0]
  print "  Maximum deviation of remapped xyz from new xyz: {:e}".format(mxd)
  print "  Minimum deviation of remapped xyz from new xyz: {:e}".format(mnd)
  print "  # deviations != 0.0: {}; # deviations: {}; ratio: {:f}".format( \
    len(nonzero),len(diffs),float(len(nonzero))/float(len(diffs)) )
  print "  # deviations < half max deviation: {}; # nonzero: {}; ratio: {:f}".format( \
    len(half),len(nonzero),float(len(half))/float(len(nonzero)) )
  print
  print "\nStep 6: Verify remapped integrals"
  xyz_swi_f=sum([v for w,v in xyz_f],V(0.,0.,0.))
  sum_f=sum(xyz_swi_f)
  print "  rectified new stepwise integrals:\n    ",repr(xyz_swi_f)
  print "  normalized & rectified new stepwise integrals:\n    ", \
    repr(xyz_swi_f/sum_f)
  print "  new rectified sum:",repr(sum_f)
  print
  #for w,v in lms_n:
  #  print "  ({}, V({:.16e}, {:.16e}, {:.16e})),".format(w,*v)

  """
  #new_tr=sum([(xyz_n[i+1][1]+t[1])/2. \
  #  for i,t in enumerate(xyz_n[:-1])],V(0.,0.,0.))
  #new_trs=sum(new_tr)
  # evidentally blunt, non-trapezoidal integration is used and the scale is not
  old_tr=sum([(xyz_lms[i+1][1]+t[1])/2. \
    for i,t in enumerate(xyz_lms[:-1])],V(0.,0.,0.))
  old_trs=sum(old_tr)
  print "old trapezoidal integrals:\n  ",repr(old_tr)
  #print "new trapezoidal integrals:\n  ",repr(new_tr)
  print "old,new sums:",repr(old_trs)#,repr(new_trs)
  print "normalized old trapezoidal integrals:\n  ",repr(old_tr/old_trs)
  #print "normalized new trapezoidal integrals:\n  ",repr(new_tr/new_trs)

  print "Now some experiments reconciling the data with trapezoidal integration"
  row=V( (.5,.5)+(0.0,)*(len(xyz_lms)) )
  m=SqM( [row>>i for i in range(len(xyz_lms)+1)] + \
         [ V((0.0,)*(len(xyz_lms)+1)+(1.0,)) , ]  )
  # m=SqM( V(0.5, 0.5, 0.0,  ....  0.0, 0.0, 0.0),
  #        V(0.0, 0.5, 0.5,  ....  0.0, 0.0, 0.0),
  #        .
  #        .
  #        V(0.0, 0.0, 0.0,  ....  0.0, 0.5, 0.5)
  #        V(0.0, 0.0, 0.0,  ....  0.0, 0.0, 1.0) )
  # len(v) == len(xyz_lms)+2
  lo_extra=(389.0, V(0.002457582178976736,0.0003361784038133919,0.01098376971503967))
  hi_extra=(389.0, V(1.4901161193847656e-06,5.960464477539062e-07,0.0))
  #'''
  # Calculation code for lo_extra,hi_extra: cycle i on xyz_lms[:3] and [-3:]
  # using line d0[0]-1 for low and line d2[0]+1 for hi
  from geometry.figure import Circle,Line
  from geometry.point import P
  d0,d1,d2 = xyz_lms[:3]; i=0
  print C(d0[0],d0[1][i]),C(d1[0],d1[1][i]),C(d2[0],d2[1][i])
  c=Circle(P(d0[0],d0[1][i],0.0),P(d1[0],d1[1][i],0.0),P(d2[0],d2[1][i],0.0))
  l=Line(P(d0[0]-1.0,0.0,0.0),P(d0[0]-1.0,1.0,0.0))
  print c
  print c.center,c.radius
  print l
  print c^l
  #'''
  # calculate augmented vectors
  # calculate intermediaries
  # verify trapezoidal integral
  # translate back to lms space
  # write interpolant class on rectified lms data
  """
  # experiement
  # sum of lms (S) local positive peak at 450 nm absolute at 545 nm
  s=((w,sum(v)) for w,v in lms_10deg_rectified)
  # difference S-M (P) negative peak at 541 nm positive at 443 nm
  p=((w,v[2]-v[1]) for w,v in lms_10deg_rectified)
  # difference M-L (Q) negative peak at 603 nm positive at 512 nm
  q=((w,v[1]-v[0]) for w,v in lms_10deg_rectified)
  # difference S-L (R) negative peak at 569 nm positive at 447 nm
  r=((w,v[2]-v[0]) for w,v in lms_10deg_rectified)
  #for t in r: print t
